define("c129df59-b7ec-487d-b748-e197e12a16f8_0.0.1",["TeamsChatEmbeddedApplicationCustomizerStrings","@microsoft/sp-application-base","react","react-dom","@microsoft/decorators"],function(n,a,i,r,o){return function(e){var t={};function n(a){if(t[a])return t[a].exports;var i=t[a]={i:a,l:!1,exports:{}};return e[a].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(a,i,function(t){return e[t]}.bind(null,i));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s="hLTl")}({"8oxB":function(e,t){var n,a,i=e.exports={};function r(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function s(e){if(n===setTimeout)return setTimeout(e,0);if((n===r||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:r}catch(e){n=r}try{a="function"==typeof clearTimeout?clearTimeout:o}catch(e){a=o}}();var c,d=[],l=!1,u=-1;function f(){l&&c&&(l=!1,c.length?d=c.concat(d):u=-1,d.length&&p())}function p(){if(!l){var e=s(f);l=!0;for(var t=d.length;t;){for(c=d,d=[];++u<t;)c&&c[u].run();u=-1,t=d.length}c=null,l=!1,function(e){if(a===clearTimeout)return clearTimeout(e);if((a===o||!a)&&clearTimeout)return a=clearTimeout,clearTimeout(e);try{a(e)}catch(t){try{return a.call(null,e)}catch(t){return a.call(this,e)}}}(e)}}function m(e,t){this.fun=e,this.array=t}function _(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];d.push(new m(e,t)),1!==d.length||l||s(p)},m.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=_,i.addListener=_,i.once=_,i.off=_,i.removeListener=_,i.removeAllListeners=_,i.emit=_,i.prependListener=_,i.prependOnceListener=_,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},"91a9":function(e,t){e.exports=n},GPet:function(e,t){e.exports=a},JPst:function(e,t,n){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map(function(t){var n=function(e,t){var n,a,i,r=e[1]||"",o=e[3];if(!o)return r;if(t&&"function"==typeof btoa){var s=(n=o,a=btoa(unescape(encodeURIComponent(JSON.stringify(n)))),i="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(a),"/*# ".concat(i," */")),c=o.sources.map(function(e){return"/*# sourceURL=".concat(o.sourceRoot).concat(e," */")});return[r].concat(c).concat([s]).join("\n")}return[r].join("\n")}(t,e);return t[2]?"@media ".concat(t[2],"{").concat(n,"}"):n}).join("")},t.i=function(e,n){"string"==typeof e&&(e=[[null,e,""]]);for(var a={},i=0;i<this.length;i++){var r=this[i][0];null!=r&&(a[r]=!0)}for(var o=0;o<e.length;o++){var s=e[o];null!=s[0]&&a[s[0]]||(n&&!s[2]?s[2]=n:n&&(s[2]="(".concat(s[2],") and (").concat(n,")")),t.push(s))}},t}},O7od:function(e,t,n){(function(t){var n;"undefined"!=typeof self&&self,n=()=>(()=>{var e={302:(e,n,a)=>{n.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const n="color: "+this.color;t.splice(1,0,n,"color: inherit");let a=0,i=0;t[0].replace(/%[a-zA-Z%]/g,e=>{"%%"!==e&&(a++,"%c"===e&&(i=a))}),t.splice(i,0,n)},n.save=function(e){try{e?n.storage.setItem("debug",e):n.storage.removeItem("debug")}catch(e){}},n.load=function(){let e;try{e=n.storage.getItem("debug")}catch(e){}return!e&&void 0!==t&&"env"in t&&(e=t.env.DEBUG),e},n.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type&&!window.process.__nwjs)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},n.storage=function(){try{return localStorage}catch(e){}}(),n.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),n.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],n.log=console.debug||console.log||(()=>{}),e.exports=a(65)(n);const{formatters:i}=e.exports;i.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}},65:(e,t,n)=>{e.exports=function(e){function t(e){let n,i,r,o=null;function s(...e){if(!s.enabled)return;const a=s,i=Number(new Date),r=i-(n||i);a.diff=r,a.prev=n,a.curr=i,n=i,e[0]=t.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let o=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,(n,i)=>{if("%%"===n)return"%";o++;const r=t.formatters[i];if("function"==typeof r){const t=e[o];n=r.call(a,t),e.splice(o,1),o--}return n}),t.formatArgs.call(a,e),(a.log||t.log).apply(a,e)}return s.namespace=e,s.useColors=t.useColors(),s.color=t.selectColor(e),s.extend=a,s.destroy=t.destroy,Object.defineProperty(s,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==o?o:(i!==t.namespaces&&(i=t.namespaces,r=t.enabled(e)),r),set:e=>{o=e}}),"function"==typeof t.init&&t.init(s),s}function a(e,n){const a=t(this.namespace+(void 0===n?":":n)+e);return a.log=this.log,a}function i(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){const e=[...t.names.map(i),...t.skips.map(i).map(e=>"-"+e)].join(",");return t.enable(""),e},t.enable=function(e){let n;t.save(e),t.namespaces=e,t.names=[],t.skips=[];const a=("string"==typeof e?e:"").split(/[\s,]+/),i=a.length;for(n=0;n<i;n++)a[n]&&("-"===(e=a[n].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.slice(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){if("*"===e[e.length-1])return!0;let n,a;for(n=0,a=t.skips.length;n<a;n++)if(t.skips[n].test(e))return!1;for(n=0,a=t.names.length;n<a;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=n(247),t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach(n=>{t[n]=e[n]}),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){let n=0;for(let t=0;t<e.length;t++)n=(n<<5)-n+e.charCodeAt(t),n|=0;return t.colors[Math.abs(n)%t.colors.length]},t.enable(t.load()),t}},247:e=>{var t=1e3,n=60*t,a=60*n,i=24*a;function r(e){if(!((e=String(e)).length>100)){var r=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(r){var o=parseFloat(r[1]);switch((r[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*o;case"weeks":case"week":case"w":return 6048e5*o;case"days":case"day":case"d":return o*i;case"hours":case"hour":case"hrs":case"hr":case"h":return o*a;case"minutes":case"minute":case"mins":case"min":case"m":return o*n;case"seconds":case"second":case"secs":case"sec":case"s":return o*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return o;default:return}}}}function o(e){var r=Math.abs(e);return r>=i?Math.round(e/i)+"d":r>=a?Math.round(e/a)+"h":r>=n?Math.round(e/n)+"m":r>=t?Math.round(e/t)+"s":e+"ms"}function s(e){var r=Math.abs(e);return r>=i?c(e,r,i,"day"):r>=a?c(e,r,a,"hour"):r>=n?c(e,r,n,"minute"):r>=t?c(e,r,t,"second"):e+" ms"}function c(e,t,n,a){var i=t>=1.5*n;return Math.round(e/n)+" "+a+(i?"s":"")}e.exports=function(e,t){t=t||{};var n=typeof e;if("string"===n&&e.length>0)return r(e);if("number"===n&&isFinite(e))return t.long?s(e):o(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}}},n={};function a(t){var i=n[t];if(void 0!==i)return i.exports;var r=n[t]={exports:{}};return e[t](r,r.exports,a),r.exports}a.d=(e,t)=>{for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),a.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var i={};return(()=>{"use strict";a.r(i),a.d(i,{ActionObjectType:()=>S,ChannelType:()=>M,ChildAppWindow:()=>Ht,DialogDimension:()=>k,ErrorCode:()=>I,FileOpenPreference:()=>y,FrameContexts:()=>E,HostClientType:()=>O,HostName:()=>w,LiveShareHost:()=>Nn,NotificationTypes:()=>Ze,ParentAppWindow:()=>Rt,SecondaryM365ContentIdName:()=>D,TaskModuleDimension:()=>P,TeamType:()=>A,UserSettingTypes:()=>et,UserTeamRole:()=>L,ViewerActionTypes:()=>$e,app:()=>ue,appEntity:()=>ea,appInitialization:()=>cn,appInstallDialog:()=>pt,authentication:()=>se,barCode:()=>bt,calendar:()=>Pt,call:()=>sn,chat:()=>gt,clipboard:()=>xt,conversations:()=>tt,dialog:()=>ce,enablePrintCapability:()=>hn,executeDeepLink:()=>Mn,files:()=>Jn,geoLocation:()=>Ct,getAdaptiveCardSchemaVersion:()=>Et,getContext:()=>gn,getMruTabInstances:()=>Ln,getTabInstances:()=>An,initialize:()=>_n,initializeWithFrameContext:()=>Tn,liveShare:()=>un,location:()=>Lt,logs:()=>Xe,mail:()=>Tt,marketplace:()=>Yn,media:()=>ht,meeting:()=>kt,meetingRoom:()=>Xn,menus:()=>de,monetization:()=>Mt,navigateBack:()=>Rn,navigateCrossDomain:()=>Hn,navigateToTab:()=>Fn,notifications:()=>Zn,openFilePreview:()=>ft,pages:()=>fe,people:()=>Ut,print:()=>bn,profile:()=>Ft,registerAppButtonClickHandler:()=>Sn,registerAppButtonHoverEnterHandler:()=>Dn,registerAppButtonHoverLeaveHandler:()=>In,registerBackButtonHandler:()=>xn,registerBeforeUnloadHandler:()=>On,registerChangeSettingsHandler:()=>En,registerCustomHandler:()=>lt,registerFocusEnterHandler:()=>wn,registerFullScreenHandler:()=>yn,registerOnLoadHandler:()=>Cn,registerOnThemeChangeHandler:()=>vn,registerUserSettingsChangeHandler:()=>ut,remoteCamera:()=>$n,returnFocus:()=>Un,search:()=>nn,secondaryBrowser:()=>At,sendCustomEvent:()=>dt,sendCustomMessage:()=>ct,setFrameContext:()=>Pn,settings:()=>dn,shareDeepLink:()=>kn,sharing:()=>an,stageView:()=>rn,tasks:()=>ln,teams:()=>ta,teamsCore:()=>le,uploadCustomApp:()=>st,version:()=>pe,video:()=>tn,videoEx:()=>aa,webStorage:()=>on});var e="2.0.1",t="2.0.3",n="1.9.0",r="1.8.0",o=["teams.microsoft.com","teams.microsoft.us","gov.teams.microsoft.us","dod.teams.microsoft.us","int.teams.microsoft.com","teams.live.com","devspaces.skype.com","ssauth.skype.com","local.teams.live.com","local.teams.live.com:8080","local.teams.office.com","local.teams.office.com:8080","outlook.office.com","outlook-sdf.office.com","outlook.office365.com","outlook-sdf.office365.com","outlook.live.com","outlook-sdf.live.com","*.teams.microsoft.com","*.www.office.com","www.office.com","word.office.com","excel.office.com","powerpoint.office.com","www.officeppe.com","*.www.microsoft365.com","www.microsoft365.com"],s=/^https:\/\//,c="https",d="teams.microsoft.com",l="The library has not yet been initialized",u=function(){function e(){}return e.initializeCalled=!1,e.initializeCompleted=!1,e.additionalValidOrigins=[],e.isFramelessWindow=!1,e.printCapabilityEnabled=!1,e}(),f=(0,a(302).debug)("teamsJs");function p(e){return f.extend(e)}const m={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let _;const h=new Uint8Array(16);function b(){if(!_&&(_="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!_))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return _(h)}const g=[];for(let e=0;e<256;++e)g.push((e+256).toString(16).slice(1));const v=function(e,t,n){if(m.randomUUID&&!t&&!e)return m.randomUUID();const a=(e=e||{}).random||(e.rng||b)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t){n=n||0;for(let e=0;e<16;++e)t[n+e]=a[e];return t}return function(e,t=0){return(g[e[t+0]]+g[e[t+1]]+g[e[t+2]]+g[e[t+3]]+"-"+g[e[t+4]]+g[e[t+5]]+"-"+g[e[t+6]]+g[e[t+7]]+"-"+g[e[t+8]]+g[e[t+9]]+"-"+g[e[t+10]]+g[e[t+11]]+g[e[t+12]]+g[e[t+13]]+g[e[t+14]]+g[e[t+15]]).toLowerCase()}(a)};var y,S,D,I,x,C,O,w,E,A,L,k;!function(e){e.Inline="inline",e.Desktop="desktop",e.Web="web"}(y||(y={})),function(e){e.M365Content="m365content"}(S||(S={})),function(e){e.DriveId="driveId",e.GroupId="groupId",e.SiteId="siteId",e.UserId="userId"}(D||(D={})),function(e){e[e.NOT_SUPPORTED_ON_PLATFORM=100]="NOT_SUPPORTED_ON_PLATFORM",e[e.INTERNAL_ERROR=500]="INTERNAL_ERROR",e[e.NOT_SUPPORTED_IN_CURRENT_CONTEXT=501]="NOT_SUPPORTED_IN_CURRENT_CONTEXT",e[e.PERMISSION_DENIED=1e3]="PERMISSION_DENIED",e[e.NETWORK_ERROR=2e3]="NETWORK_ERROR",e[e.NO_HW_SUPPORT=3e3]="NO_HW_SUPPORT",e[e.INVALID_ARGUMENTS=4e3]="INVALID_ARGUMENTS",e[e.UNAUTHORIZED_USER_OPERATION=5e3]="UNAUTHORIZED_USER_OPERATION",e[e.INSUFFICIENT_RESOURCES=6e3]="INSUFFICIENT_RESOURCES",e[e.THROTTLE=7e3]="THROTTLE",e[e.USER_ABORT=8e3]="USER_ABORT",e[e.OPERATION_TIMED_OUT=8001]="OPERATION_TIMED_OUT",e[e.OLD_PLATFORM=9e3]="OLD_PLATFORM",e[e.FILE_NOT_FOUND=404]="FILE_NOT_FOUND",e[e.SIZE_EXCEEDED=1e4]="SIZE_EXCEEDED"}(I||(I={})),function(e){e.GeoLocation="geolocation",e.Media="media"}(x||(x={})),function(e){e.TextPlain="text/plain",e.TextHtml="text/html",e.ImagePNG="image/png",e.ImageJPEG="image/jpeg"}(C||(C={})),function(e){e.desktop="desktop",e.web="web",e.android="android",e.ios="ios",e.ipados="ipados",e.macos="macos",e.rigel="rigel",e.surfaceHub="surfaceHub",e.teamsRoomsWindows="teamsRoomsWindows",e.teamsRoomsAndroid="teamsRoomsAndroid",e.teamsPhones="teamsPhones",e.teamsDisplays="teamsDisplays"}(O||(O={})),function(e){e.office="Office",e.outlook="Outlook",e.outlookWin32="OutlookWin32",e.orange="Orange",e.teams="Teams",e.teamsModern="TeamsModern"}(w||(w={})),function(e){e.settings="settings",e.content="content",e.authentication="authentication",e.remove="remove",e.task="task",e.sidePanel="sidePanel",e.stage="stage",e.meetingStage="meetingStage"}(E||(E={})),function(e){e[e.Standard=0]="Standard",e[e.Edu=1]="Edu",e[e.Class=2]="Class",e[e.Plc=3]="Plc",e[e.Staff=4]="Staff"}(A||(A={})),function(e){e[e.Admin=0]="Admin",e[e.User=1]="User",e[e.Guest=2]="Guest"}(L||(L={})),function(e){e.Large="large",e.Medium="medium",e.Small="small"}(k||(k={}));var M,P=k;!function(e){e.Regular="Regular",e.Private="Private",e.Shared="Shared"}(M||(M={}));var T={errorCode:I.NOT_SUPPORTED_ON_PLATFORM},U={adaptiveCardSchemaVersion:{majorVersion:1,minorVersion:5}};function F(e,t){if("*."===e.substring(0,2)){var n=e.substring(1);if(t.length>n.length&&t.split(".").length===n.split(".").length&&t.substring(t.length-n.length)===n)return!0}else if(e===t)return!0;return!1}var H=p("validateOrigin");function R(e){return function(t,n){if(!t)throw new Error(e||n)}}function N(e,t){if("string"!=typeof e||"string"!=typeof t)return NaN;var n=e.split("."),a=t.split(".");function i(e){return/^\d+$/.test(e)}if(!n.every(i)||!a.every(i))return NaN;for(;n.length<a.length;)n.push("0");for(;a.length<n.length;)a.push("0");for(var r=0;r<n.length;++r)if(Number(n[r])!=Number(a[r]))return Number(n[r])>Number(a[r])?1:-1;return 0}function B(){return v()}function j(e){return Object.keys(e).forEach(function(t){"object"==typeof e[t]&&j(e[t])}),Object.freeze(e)}function V(e,t){for(var n=[],a=2;a<arguments.length;a++)n[a-2]=arguments[a];var i=e.apply(void 0,n);return i.then(function(){t&&t(null)}).catch(function(e){t&&t(e)}),i}function z(e){return!(N("".concat(e.majorVersion,".").concat(e.minorVersion),"".concat(1,".").concat(5))>=0)}function G(e){return"https:"===e.protocol}function K(e,t){return new Promise(function(n,a){e||a("MimeType cannot be null or empty."),t||a("Base64 string cannot be null or empty.");var i=atob(t);if(e.startsWith("image/")){for(var r=new Uint8Array(i.length),o=0;o<i.length;o++)r[o]=i.charCodeAt(o);n(new Blob([r],{type:e}))}n(new Blob([i],{type:e}))})}function W(e){return new Promise(function(t,n){0===e.size&&n(new Error("Blob cannot be empty."));var a=new FileReader;a.onloadend=function(){a.result?t(a.result.toString().split(",")[1]):n(new Error("Failed to read the blob"))},a.onerror=function(){n(a.error)},a.readAsDataURL(e)})}function q(){if(Q())throw new Error("window object undefined at SSR check");return window}function Q(){return"undefined"==typeof window}var Y=function(){return Y=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Y.apply(this,arguments)},J=p("runtime");function X(e){return 3===e.apiVersion}function Z(e){if(X(e))return!0;throw-1===e.apiVersion?new Error("The runtime has not yet been initialized"):new Error("The runtime version is not supported")}var $={apiVersion:-1,supports:{}},ee={appInstallDialog:{},appEntity:{},call:{},chat:{},conversations:{},dialog:{card:{bot:{}},url:{bot:{}},update:{}},interactive:{},logs:{},meetingRoom:{},menus:{},monetization:{},notifications:{},pages:{appButton:{},tabs:{},config:{},backStack:{},fullTrust:{}},remoteCamera:{},stageView:{},teams:{fullTrust:{}},teamsCore:{},video:{sharedFrame:{}}},te=[O.desktop,O.web,O.android,O.ios,O.rigel,O.surfaceHub,O.teamsRoomsWindows,O.teamsRoomsAndroid,O.teamsPhones,O.teamsDisplays],ne=[{versionToUpgradeFrom:1,upgradeToNextVersion:function(e){var t;return{apiVersion:2,hostVersionsInfo:void 0,isLegacyTeams:e.isLegacyTeams,supports:Y(Y({},e.supports),{dialog:e.supports.dialog?{card:void 0,url:e.supports.dialog,update:null===(t=e.supports.dialog)||void 0===t?void 0:t.update}:void 0})}}},{versionToUpgradeFrom:2,upgradeToNextVersion:function(e){var t=e.supports,n=(t.appNotification,function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(a=Object.getOwnPropertySymbols(e);i<a.length;i++)t.indexOf(a[i])<0&&Object.prototype.propertyIsEnumerable.call(e,a[i])&&(n[a[i]]=e[a[i]])}return n}(t,["appNotification"]));return Y(Y({},e),{apiVersion:3,supports:n})}}],ae={"1.9.0":[{capability:{location:{}},hostClientTypes:te}],"2.0.0":[{capability:{people:{}},hostClientTypes:te},{capability:{sharing:{}},hostClientTypes:[O.desktop,O.web]}],"2.0.1":[{capability:{teams:{fullTrust:{joinedTeams:{}}}},hostClientTypes:[O.android,O.desktop,O.ios,O.teamsRoomsAndroid,O.teamsPhones,O.teamsDisplays,O.web]},{capability:{webStorage:{}},hostClientTypes:[O.desktop]}],"2.0.5":[{capability:{webStorage:{}},hostClientTypes:[O.android,O.desktop,O.ios]}]},ie=J.extend("generateBackCompatRuntimeConfig"),re=J.extend("applyRuntimeConfig");function oe(e){"string"==typeof e.apiVersion&&(re("Trying to apply runtime with string apiVersion, processing as v1: %o",e),e=Y(Y({},e),{apiVersion:1})),re("Fast-forwarding runtime %o",e);var t=function(e){var t=e;if(t.apiVersion<3&&ne.forEach(function(e){t.apiVersion===e.versionToUpgradeFrom&&(t=e.upgradeToNextVersion(t))}),X(t))return t;throw new Error("Received a runtime that could not be upgraded to the latest version")}(e);re("Applying runtime %o",t),$=j(t)}var se,ce,de,le,ue,fe,pe="2.15.0",me=p("internal"),_e=me.extend("ensureInitializeCalled"),he=me.extend("ensureInitialized");function be(){if(!u.initializeCalled)throw _e(l),new Error(l)}function ge(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(!u.initializeCompleted)throw he("%s. initializeCalled: %s",l,u.initializeCalled.toString()),new Error(l);if(t&&t.length>0){for(var a=!1,i=0;i<t.length;i++)if(t[i]===u.frameContext){a=!0;break}if(!a)throw new Error("This call is only allowed in following contexts: ".concat(JSON.stringify(t),". ")+'Current context: "'.concat(u.frameContext,'".'))}return Z(e)}function ve(t){void 0===t&&(t=e);var n=N(u.clientSupportedSDKVersion,t);return!isNaN(n)&&n>=0}function ye(){return u.hostClientType==O.android||u.hostClientType==O.ios||u.hostClientType==O.ipados}function Se(t){if(void 0===t&&(t=e),!ye())throw{errorCode:I.NOT_SUPPORTED_ON_PLATFORM};if(!ve(t))throw{errorCode:I.OLD_PLATFORM}}!function(e){var t,n,a;function i(e){return new Promise(function(n,a){if(u.hostClientType===O.desktop||u.hostClientType===O.android||u.hostClientType===O.ios||u.hostClientType===O.ipados||u.hostClientType===O.macos||u.hostClientType===O.rigel||u.hostClientType===O.teamsRoomsWindows||u.hostClientType===O.teamsRoomsAndroid||u.hostClientType===O.teamsPhones||u.hostClientType===O.teamsDisplays||u.hostClientType===O.surfaceHub){var i=document.createElement("a");i.href=e.url,n(je("authentication.authenticate",[i.href,e.width,e.height,e.isExternal]).then(function(e){var t=e[0],n=e[1];if(t)return n;throw new Error(n)}))}else t={success:n,fail:a},function(e){r();var t=e.width||600,n=e.height||400;t=Math.min(t,Ue.currentWindow.outerWidth-400),n=Math.min(n,Ue.currentWindow.outerHeight-200);var a=document.createElement("a");a.href=e.url.replace("{oauthRedirectMethod}","web");var i=void 0!==Ue.currentWindow.screenLeft?Ue.currentWindow.screenLeft:Ue.currentWindow.screenX,o=void 0!==Ue.currentWindow.screenTop?Ue.currentWindow.screenTop:Ue.currentWindow.screenY;i+=Ue.currentWindow.outerWidth/2-t/2,o+=Ue.currentWindow.outerHeight/2-n/2,Ue.childWindow=Ue.currentWindow.open(a.href,"_blank","toolbar=no, location=yes, status=no, menubar=no, scrollbars=yes, top="+o+", left="+i+", width="+t+", height="+n),Ue.childWindow?s():d("FailedToOpenWindow")}(e)})}function r(){o();try{Ue.childWindow&&Ue.childWindow.close()}finally{Ue.childWindow=null,Ue.childOrigin=null}}function o(){n&&(clearInterval(n),n=0),Ee("initialize"),Ee("navigateCrossDomain")}function s(){o(),n=Ue.currentWindow.setInterval(function(){if(!Ue.childWindow||Ue.childWindow.closed)d("CancelledByUser");else{var e=Ue.childOrigin;try{Ue.childOrigin="*",ot("ping")}finally{Ue.childOrigin=e}}},100),we("initialize",function(){return[E.authentication,u.hostClientType]}),we("navigateCrossDomain",function(){return!1})}function c(e){try{t&&t.success(e)}finally{t=null,r()}}function d(e){try{t&&t.fail(new Error(e))}finally{t=null,r()}}function l(e,t,n){if(e){var a=document.createElement("a");a.href=decodeURIComponent(e),a.host&&a.host!==q().location.host&&"outlook.office.com"===a.host&&a.search.indexOf("client_type=Win32_Outlook")>-1&&(t&&"result"===t&&(n&&(a.href=f(a.href,"result",n)),Ue.currentWindow.location.assign(f(a.href,"authSuccess",""))),t&&"reason"===t&&(n&&(a.href=f(a.href,"reason",n)),Ue.currentWindow.location.assign(f(a.href,"authFailure",""))))}}function f(e,t,n){var a=e.indexOf("#"),i=-1===a?"#":e.substr(a);return i=i+"&"+t+(""!==n?"="+n:""),(e=-1===a?e:e.substr(0,a))+i}e.initialize=function(){we("authentication.authenticate.success",c,!1),we("authentication.authenticate.failure",d,!1)},e.registerAuthenticationHandlers=function(e){a=e},e.authenticate=function(e){var t=void 0!==e,n=t?e:a;if(!n)throw new Error("No parameters are provided for authentication");return ge($,E.content,E.sidePanel,E.settings,E.remove,E.task,E.stage,E.meetingStage),i(n).then(function(e){try{return n&&n.successCallback?(n.successCallback(e),""):e}finally{t||(a=null)}}).catch(function(e){try{if(n&&n.failureCallback)return n.failureCallback(e.message),"";throw e}finally{t||(a=null)}})},e.getAuthToken=function(e){return be(),function(e){return new Promise(function(t){t(je("authentication.getAuthToken",[null==e?void 0:e.resources,null==e?void 0:e.claims,null==e?void 0:e.silent]))}).then(function(e){var t=e[0],n=e[1];if(t)return n;throw new Error(n)})}(e).then(function(t){return e&&e.successCallback?(e.successCallback(t),""):t}).catch(function(t){if(e&&e.failureCallback)return e.failureCallback(t.message),"";throw t})},e.getUser=function(e){return be(),new Promise(function(e){e(je("authentication.getUser"))}).then(function(e){var t=e[0],n=e[1];if(t)return n;throw new Error(n)}).then(function(t){return e&&e.successCallback?(e.successCallback(t),null):t}).catch(function(t){if(e&&e.failureCallback)return e.failureCallback(t.message),null;throw t})},e.notifySuccess=function(e,t){l(t,"result",e),ge($,E.authentication),Ve("authentication.authenticate.success",[e]),it(Ue.parentWindow,function(){return setTimeout(function(){return Ue.currentWindow.close()},200)})},e.notifyFailure=function(e,t){l(t,"reason",e),ge($,E.authentication),Ve("authentication.authenticate.failure",[e]),it(Ue.parentWindow,function(){return setTimeout(function(){return Ue.currentWindow.close()},200)})},function(e){e.Public="public",e.EUDB="eudb",e.Other="other"}(e.DataResidency||(e.DataResidency={}))}(se||(se={})),function(e){var t=[];function n(e){u.frameContext&&(u.frameContext===E.task?t.push(e):Ee("messageForChild"))}e.initialize=function(){we("messageForChild",n,!1)},function(e){function n(){return ge($)&&void 0!==($.supports.dialog&&$.supports.dialog.url)}function a(e){return{url:e.url,height:e.size?e.size.height:k.Small,width:e.size?e.size.width:k.Small,title:e.title,fallbackUrl:e.fallbackUrl}}function i(e){var t=a(e);return t.completionBotId=e.completionBotId,t}e.open=function(e,t,i){if(ge($,E.content,E.sidePanel,E.meetingStage),!n())throw T;i&&we("messageForParent",i),Ve("tasks.startTask",[a(e)],function(e,n){null==t||t({err:e,result:n}),Ee("messageForParent")})},e.submit=function(e,t){if(ge($,E.content,E.task),!n())throw T;Ve("tasks.completeTask",[e,t?Array.isArray(t)?t:[t]:[]])},e.sendMessageToParentFromDialog=function(e){if(ge($,E.task),!n())throw T;Ve("messageForParent",[e])},e.sendMessageToDialog=function(e){if(ge($,E.content,E.sidePanel,E.meetingStage),!n())throw T;Ve("messageForChild",[e])},e.registerOnMessageFromParent=function(e){if(ge($,E.task),!n())throw T;for(Ee("messageForChild"),we("messageForChild",e),t.reverse();t.length>0;)e(t.pop())},e.isSupported=n,function(e){function t(){return ge($)&&void 0!==($.supports.dialog&&$.supports.dialog.url&&$.supports.dialog.url.bot)}e.open=function(e,n,a){if(ge($,E.content,E.sidePanel,E.meetingStage),!t())throw T;a&&we("messageForParent",a),Ve("tasks.startTask",[i(e)],function(e,t){null==n||n({err:e,result:t}),Ee("messageForParent")})},e.isSupported=t}(e.bot||(e.bot={})),e.getDialogInfoFromUrlDialogInfo=a,e.getDialogInfoFromBotUrlDialogInfo=i}(e.url||(e.url={})),e.isSupported=function(){return!(!ge($)||!$.supports.dialog)},function(e){function t(){return!(!ge($)||!$.supports.dialog||!$.supports.dialog.update)}e.resize=function(e){if(ge($,E.content,E.sidePanel,E.task,E.meetingStage),!t())throw T;Ve("tasks.updateTask",[e])},e.isSupported=t}(e.update||(e.update={})),function(e){function t(){var e=$.hostVersionsInfo&&$.hostVersionsInfo.adaptiveCardSchemaVersion&&!z($.hostVersionsInfo.adaptiveCardSchemaVersion);return ge($)&&void 0!==(e&&$.supports.dialog&&$.supports.dialog.card)}function n(e){return{card:e.card,height:e.size?e.size.height:k.Small,width:e.size?e.size.width:k.Small,title:e.title}}function a(e){var t=n(e);return t.completionBotId=e.completionBotId,t}e.open=function(e,a){if(ge($,E.content,E.sidePanel,E.meetingStage),!t())throw T;Ve("tasks.startTask",[n(e)],function(e,t){null==a||a({err:e,result:t})})},e.isSupported=t,function(e){function t(){var e=$.hostVersionsInfo&&$.hostVersionsInfo.adaptiveCardSchemaVersion&&!z($.hostVersionsInfo.adaptiveCardSchemaVersion);return ge($)&&void 0!==(e&&$.supports.dialog&&$.supports.dialog.card&&$.supports.dialog.card.bot)}e.open=function(e,n){if(ge($,E.content,E.sidePanel,E.meetingStage),!t())throw T;Ve("tasks.startTask",[a(e)],function(e,t){null==n||n({err:e,result:t})})},e.isSupported=t}(e.bot||(e.bot={}))}(e.adaptiveCard||(e.adaptiveCard={}))}(ce||(ce={})),function(e){var t,n,a;function i(e){a&&a(e)||(ge($),Ve("viewConfigItemPress",[e]))}function r(e){t&&t(e)||(ge($),Ve("handleNavBarMenuItemPress",[e]))}function o(e){n&&n(e)||(ge($),Ve("handleActionMenuItemPress",[e]))}function s(){return!(!ge($)||!$.supports.menus)}!function(e){e[e.ifRoom=0]="ifRoom",e[e.overflowOnly=1]="overflowOnly"}(e.DisplayMode||(e.DisplayMode={})),e.MenuItem=function(){this.enabled=!0,this.selected=!1},function(e){e.dropDown="dropDown",e.popOver="popOver"}(e.MenuListType||(e.MenuListType={})),e.initialize=function(){we("navBarMenuItemPress",r,!1),we("actionMenuItemPress",o,!1),we("setModuleView",i,!1)},e.setUpViews=function(e,t){if(ge($),!s())throw T;a=t,Ve("setUpViews",[e])},e.setNavBarMenu=function(e,n){if(ge($),!s())throw T;t=n,Ve("setNavBarMenu",[e])},e.showActionMenu=function(e,t){if(ge($),!s())throw T;n=t,Ve("showActionMenu",[e])},e.isSupported=s}(de||(de={})),function(e){function t(){q().print()}function n(e,t){e&&ge($),e&&t&&t(),function(e){xe.loadHandler=e,e&&Ve("registerHandler",["load"])}(e)}function a(e,t){e&&ge($),e&&t&&t(),function(e){xe.beforeUnloadHandler=e,e&&Ve("registerHandler",["beforeUnload"])}(e)}function i(){return!(!ge($)||!$.supports.teamsCore)}e.enablePrintCapability=function(){if(!u.printCapabilityEnabled){if(ge($),!i())throw T;u.printCapabilityEnabled=!0,document.addEventListener("keydown",function(e){(e.ctrlKey||e.metaKey)&&80===e.keyCode&&(t(),e.cancelBubble=!0,e.preventDefault(),e.stopImmediatePropagation())})}},e.print=t,e.registerOnLoadHandler=function(e){n(e,function(){if(e&&!i())throw T})},e.registerOnLoadHandlerHelper=n,e.registerBeforeUnloadHandler=function(e){a(e,function(){if(e&&!i())throw T})},e.registerBeforeUnloadHandlerHelper=a,e.isSupported=i}(le||(le={})),function(t){var n=p("app");t.Messages={AppLoaded:"appInitialization.appLoaded",Success:"appInitialization.success",Failure:"appInitialization.failure",ExpectedFailure:"appInitialization.expectedFailure"},function(e){e.AuthFailed="AuthFailed",e.Timeout="Timeout",e.Other="Other"}(t.FailedReason||(t.FailedReason={})),function(e){e.PermissionError="PermissionError",e.NotFound="NotFound",e.Throttling="Throttling",e.Offline="Offline",e.Other="Other"}(t.ExpectedFailureReason||(t.ExpectedFailureReason={})),t.isInitialized=function(){return u.initializeCompleted},t.getFrameContext=function(){return u.frameContext},t.initialize=function(e){return Q()?(n.extend("initialize")("window object undefined at initialization"),Promise.resolve()):function(e,t,n){return new Promise(function(t,a){var i=setTimeout(a,5e3,n);e().then(function(e){clearTimeout(i),t(e)}).catch(function(e){clearTimeout(i),a(e)})})}(function(){return i(e)},0,new Error("SDK initialization timed out."))};var a=n.extend("initializeHelper");function i(t){return new Promise(function(n){u.initializeCalled||(u.initializeCalled=!0,xe.handlers.themeChange=Le,xe.handlers.load=ke,xe.handlers.beforeUnload=Me,fe.backStack._initialize(),u.initializePromise=function(e){if(Fe.messageListener=function(e){return function(e){if(e&&e.data&&"object"==typeof e.data){var t=e.source||e.originalEvent&&e.originalEvent.source,n=e.origin||e.originalEvent&&e.originalEvent.origin;!function(e,t){if(Ue.currentWindow&&e===Ue.currentWindow)return We("Should not process message because it is coming from the current window"),!1;if(Ue.currentWindow&&Ue.currentWindow.location&&t&&t===Ue.currentWindow.location.origin)return!0;var n=function(e){if(!G(e))return H("Origin %s is invalid because it is not using https protocol. Protocol being used: %s",e,e.protocol),!1;var t=e.host;if(o.some(function(e){return F(e,t)}))return!0;for(var n=0,a=u.additionalValidOrigins;n<a.length;n++){var i=a[n];if(F("https://"===i.substring(0,8)?i.substring(8):i,t))return!0}return H("Origin %s is invalid because it is not an origin approved by this library or included in the call to app.initialize.\nOrigins approved by this library: %o\nOrigins included in app.initialize: %o",e,o,u.additionalValidOrigins),!1}(new URL(t));return n||We("Message has an invalid origin of %s",t),n}(t,n)?Ke("Message being ignored by app because it is either coming from the current window or a different window with an invalid origin"):(function(e,t){u.isFramelessWindow||Ue.parentWindow&&!Ue.parentWindow.closed&&e!==Ue.parentWindow?Ue.childWindow&&!Ue.childWindow.closed&&e!==Ue.childWindow||(Ue.childWindow=e,Ue.childOrigin=t):(Ue.parentWindow=e,Ue.parentOrigin=t),Ue.parentWindow&&Ue.parentWindow.closed&&(Ue.parentWindow=null,Ue.parentOrigin=null),Ue.childWindow&&Ue.childWindow.closed&&(Ue.childWindow=null,Ue.childOrigin=null),at(Ue.parentWindow),at(Ue.childWindow)}(t,n),t===Ue.parentWindow?Qe(e):t===Ue.childWindow&&function(e){if("id"in e.data&&"func"in e.data){var t=e.data,n=Oe(t.func,t.args),a=n[0],i=n[1];a&&void 0!==i?rt(t.id,Array.isArray(i)?i:[i]):Ve(t.func,t.args,function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];if(Ue.childWindow){var a=e.pop();rt(t.id,e,a)}})}}(e))}else Ke("Unrecognized message format received by app, message being ignored. Message: %o",e)}(e)},Ue.currentWindow=Ue.currentWindow||q(),Ue.parentWindow=Ue.currentWindow.parent!==Ue.currentWindow.self?Ue.currentWindow.parent:Ue.currentWindow.opener,(Ue.parentWindow||e)&&Ue.currentWindow.addEventListener("message",Fe.messageListener,!1),!Ue.parentWindow){var t=Ue.currentWindow;if(!t.nativeInterface)return Promise.reject(new Error("Initialization Failed. No Parent window found."));u.isFramelessWindow=!0,t.onNativeMessage=Qe}try{return Ue.parentOrigin="*",je("initialize",[pe,3]).then(function(e){return{context:e[0],clientType:e[1],runtimeConfig:e[2],clientSupportedSDKVersion:e[3]}})}finally{Ue.parentOrigin=null}}(t).then(function(t){var n=t.context,i=t.clientType,r=t.runtimeConfig,o=t.clientSupportedSDKVersion,s=void 0===o?e:o;u.frameContext=n,u.hostClientType=i,u.clientSupportedSDKVersion=s;try{a("Parsing %s",r);var c=JSON.parse(r);if(a("Checking if %o is a valid runtime object",null!=c?c:"null"),!c||!c.apiVersion)throw new Error("Received runtime config is invalid");r&&oe(c)}catch(t){if(!(t instanceof SyntaxError))throw t;try{if(a("Attempting to parse %s as an SDK version",r),isNaN(N(r,e))||(u.clientSupportedSDKVersion=r),c=JSON.parse(s),a("givenRuntimeConfig parsed to %o",null!=c?c:"null"),!c)throw new Error("givenRuntimeConfig string was successfully parsed. However, it parsed to value of null");oe(c)}catch(e){if(!(e instanceof SyntaxError))throw e;oe(function(e){ie("generating back compat runtime config for %s",e);var t=Y({},ee);ie("Supported capabilities in config before updating based on highestSupportedVersion: %o",t),Object.keys(ae).forEach(function(n){N(e,n)>=0&&ae[n].forEach(function(e){e.hostClientTypes.includes(u.hostClientType)&&(t=Y(Y({},t),e.capability))})});var n={apiVersion:3,hostVersionsInfo:U,isLegacyTeams:!0,supports:t};return ie("Runtime config after updating based on highestSupportedVersion: %o",n),n}(u.clientSupportedSDKVersion))}}u.initializeCompleted=!0}),se.initialize(),de.initialize(),fe.config.initialize(),ce.initialize()),Array.isArray(t)&&function(e){var t=u.additionalValidOrigins.concat(e.filter(function(e){return"string"==typeof e&&s.test(e)})),n={};t=t.filter(function(e){return!n[e]&&(n[e]=!0,!0)}),u.additionalValidOrigins=t}(t),n(u.initializePromise)})}function r(e){e&&be(),function(e){xe.themeChangeHandler=e,e&&Ve("registerHandler",["themeChange"])}(e)}t._initialize=function(e){Ue.currentWindow=e},t._uninitialize=function(){u.initializeCalled&&(u.frameContext&&(r(null),fe.backStack.registerBackButtonHandler(null),fe.registerFullScreenHandler(null),le.registerBeforeUnloadHandler(null),le.registerOnLoadHandler(null),Xe.registerGetLogHandler(null)),u.frameContext===E.settings&&fe.config.registerOnSaveHandler(null),u.frameContext===E.remove&&fe.config.registerOnRemoveHandler(null),u.initializeCalled=!1,u.initializeCompleted=!1,u.initializePromise=null,u.additionalValidOrigins=[],u.frameContext=null,u.hostClientType=null,u.isFramelessWindow=!1,Ue.currentWindow&&Ue.currentWindow.removeEventListener("message",Fe.messageListener,!1),Ue.currentWindow=null,Ue.parentWindow=null,Ue.parentOrigin=null,Ue.childWindow=null,Ue.childOrigin=null,Fe.parentMessageQueue=[],Fe.childMessageQueue=[],Fe.nextMessageId=0,Fe.callbacks={},Fe.promiseCallbacks={})},t.getContext=function(){return new Promise(function(e){be(),e(He("getContext"))}).then(function(e){return function(e){return{actionInfo:e.actionInfo,app:{locale:e.locale,sessionId:e.appSessionId?e.appSessionId:"",theme:e.theme?e.theme:"default",iconPositionVertical:e.appIconPosition,osLocaleInfo:e.osLocaleInfo,parentMessageId:e.parentMessageId,userClickTime:e.userClickTime,userFileOpenPreference:e.userFileOpenPreference,host:{name:e.hostName?e.hostName:w.teams,clientType:e.hostClientType?e.hostClientType:O.web,sessionId:e.sessionId?e.sessionId:"",ringId:e.ringId},appLaunchId:e.appLaunchId},page:{id:e.entityId,frameContext:e.frameContext?e.frameContext:u.frameContext,subPageId:e.subEntityId,isFullScreen:e.isFullScreen,isMultiWindow:e.isMultiWindow,sourceOrigin:e.sourceOrigin},user:{id:e.userObjectId,displayName:e.userDisplayName,isCallingAllowed:e.isCallingAllowed,isPSTNCallingAllowed:e.isPSTNCallingAllowed,licenseType:e.userLicenseType,loginHint:e.loginHint,userPrincipalName:e.userPrincipalName,tenant:e.tid?{id:e.tid,teamsSku:e.tenantSKU}:void 0},channel:e.channelId?{id:e.channelId,displayName:e.channelName,relativeUrl:e.channelRelativeUrl,membershipType:e.channelType,defaultOneNoteSectionId:e.defaultOneNoteSectionId,ownerGroupId:e.hostTeamGroupId,ownerTenantId:e.hostTeamTenantId}:void 0,chat:e.chatId?{id:e.chatId}:void 0,meeting:e.meetingId?{id:e.meetingId}:void 0,sharepoint:e.sharepoint,team:e.teamId?{internalId:e.teamId,displayName:e.teamName,type:e.teamType,groupId:e.groupId,templateId:e.teamTemplateId,isArchived:e.isTeamArchived,userRole:e.userTeamRole}:void 0,sharePointSite:e.teamSiteUrl||e.teamSiteDomain||e.teamSitePath||e.mySitePath||e.mySiteDomain?{teamSiteUrl:e.teamSiteUrl,teamSiteDomain:e.teamSiteDomain,teamSitePath:e.teamSitePath,teamSiteId:e.teamSiteId,mySitePath:e.mySitePath,mySiteDomain:e.mySiteDomain}:void 0}}(e)})},t.notifyAppLoaded=function(){be(),Ve(t.Messages.AppLoaded,[pe])},t.notifySuccess=function(){be(),Ve(t.Messages.Success,[pe])},t.notifyFailure=function(e){be(),Ve(t.Messages.Failure,[e.reason,e.message])},t.notifyExpectedFailure=function(e){be(),Ve(t.Messages.ExpectedFailure,[e.reason,e.message])},t.registerOnThemeChangeHandler=r,t.openLink=function(e){return new Promise(function(t){ge($,E.content,E.sidePanel,E.settings,E.task,E.stage,E.meetingStage),t(Re("executeDeepLink",e))})}}(ue||(ue={})),function(e){function t(e){if(ge($,E.content),!n())throw T;Ve("setFrameContext",[e])}function n(){return!(!ge($)||!$.supports.pages)}e.returnFocus=function(e){if(ge($),!n())throw T;Ve("returnFocus",[e])},e.registerFocusEnterHandler=function(e){Ae("focusEnter",e,[],function(){if(!n())throw T})},e.setCurrentFrame=t,e.initializeWithFrameContext=function(e,n,a){ue.initialize(a).then(function(){return n&&n()}),t(e)},e.getConfig=function(){return new Promise(function(e){if(ge($,E.content,E.settings,E.remove,E.sidePanel),!n())throw T;e(He("settings.getSettings"))})},e.navigateCrossDomain=function(e){return new Promise(function(t){if(ge($,E.content,E.sidePanel,E.settings,E.remove,E.task,E.stage,E.meetingStage),!n())throw T;t(Ne("navigateCrossDomain","Cross-origin navigation is only supported for URLs matching the pattern registered in the manifest.",e))})},e.navigateToApp=function(e){return new Promise(function(t){if(ge($,E.content,E.sidePanel,E.settings,E.task,E.stage,E.meetingStage),!n())throw T;$.isLegacyTeams?t(Re("executeDeepLink",function(e){var t=new URL("https://teams.microsoft.com/l/entity/"+encodeURIComponent(e.appId)+"/"+encodeURIComponent(e.pageId));return e.webUrl&&t.searchParams.append("webUrl",e.webUrl),(e.channelId||e.subPageId)&&t.searchParams.append("context",JSON.stringify({channelId:e.channelId,subEntityId:e.subPageId})),t.toString()}(e))):t(Re("pages.navigateToApp",e))})},e.shareDeepLink=function(e){if(ge($,E.content,E.sidePanel,E.meetingStage),!n())throw T;Ve("shareDeepLink",[e.subPageId,e.subPageLabel,e.subPageWebUrl])},e.registerFullScreenHandler=function(e){Ae("fullScreenChange",e,[],function(){if(e&&!n())throw T})},e.isSupported=n,function(e){function t(){return!(!ge($)||!$.supports.pages||!$.supports.pages.tabs)}e.navigateToTab=function(e){return new Promise(function(n){if(ge($),!t())throw T;n(Ne("navigateToTab","Invalid internalTabInstanceId and/or channelId were/was provided",e))})},e.getTabInstances=function(e){return new Promise(function(n){if(ge($),!t())throw T;n(He("getTabInstances",e))})},e.getMruTabInstances=function(e){return new Promise(function(n){if(ge($),!t())throw T;n(He("getMruTabInstances",e))})},e.isSupported=t}(e.tabs||(e.tabs={})),function(e){var t,n;function a(e,n){e&&ge($,E.settings),n&&n(),t=e,e&&Ve("registerHandler",["save"])}function i(e,t){e&&ge($,E.remove,E.settings),t&&t(),n=e,e&&Ve("registerHandler",["remove"])}function r(e){var n=new o(e);t?t(n):Ue.childWindow?ot("settings.save",[e]):n.notifySuccess()}e.initialize=function(){we("settings.save",r,!1),we("settings.remove",s,!1)},e.setValidityState=function(e){if(ge($,E.settings,E.remove),!d())throw T;Ve("settings.setValidityState",[e])},e.setConfig=function(e){return new Promise(function(t){if(ge($,E.content,E.settings,E.sidePanel),!d())throw T;t(Re("settings.setSettings",e))})},e.registerOnSaveHandler=function(e){a(e,function(){if(e&&!d())throw T})},e.registerOnSaveHandlerHelper=a,e.registerOnRemoveHandler=function(e){i(e,function(){if(e&&!d())throw T})},e.registerOnRemoveHandlerHelper=i,e.registerChangeConfigHandler=function(e){Ae("changeSettings",e,[E.content],function(){if(!d())throw T})};var o=function(){function e(e){this.notified=!1,this.result=e||{}}return e.prototype.notifySuccess=function(){this.ensureNotNotified(),Ve("settings.save.success"),this.notified=!0},e.prototype.notifyFailure=function(e){this.ensureNotNotified(),Ve("settings.save.failure",[e]),this.notified=!0},e.prototype.ensureNotNotified=function(){if(this.notified)throw new Error("The SaveEvent may only notify success or failure once.")},e}();function s(){var e=new c;n?n(e):Ue.childWindow?ot("settings.remove",[]):e.notifySuccess()}var c=function(){function e(){this.notified=!1}return e.prototype.notifySuccess=function(){this.ensureNotNotified(),Ve("settings.remove.success"),this.notified=!0},e.prototype.notifyFailure=function(e){this.ensureNotNotified(),Ve("settings.remove.failure",[e]),this.notified=!0},e.prototype.ensureNotNotified=function(){if(this.notified)throw new Error("The removeEventType may only notify success or failure once.")},e}();function d(){return!(!ge($)||!$.supports.pages||!$.supports.pages.config)}e.isSupported=d}(e.config||(e.config={})),function(e){var t;function n(){return new Promise(function(e){if(ge($),!r())throw T;e(Ne("navigateBack","Back navigation is not supported in the current client or context."))})}function a(e,n){e&&ge($),n&&n(),t=e,e&&Ve("registerHandler",["backButton"])}function i(){t&&t()||(Ue.childWindow?ot("backButtonPress",[]):n())}function r(){return!(!ge($)||!$.supports.pages||!$.supports.pages.backStack)}e._initialize=function(){we("backButtonPress",i,!1)},e.navigateBack=n,e.registerBackButtonHandler=function(e){a(e,function(){if(e&&!r())throw T})},e.registerBackButtonHandlerHelper=a,e.isSupported=r}(e.backStack||(e.backStack={})),function(e){function t(){return!(!ge($)||!$.supports.pages||!$.supports.pages.fullTrust)}e.enterFullscreen=function(){if(ge($,E.content),!t())throw T;Ve("enterFullscreen",[])},e.exitFullscreen=function(){if(ge($,E.content),!t())throw T;Ve("exitFullscreen",[])},e.isSupported=t}(e.fullTrust||(e.fullTrust={})),function(e){function t(){return!(!ge($)||!$.supports.pages||!$.supports.pages.appButton)}e.onClick=function(e){Ae("appButtonClick",e,[E.content],function(){if(!t())throw T})},e.onHoverEnter=function(e){Ae("appButtonHoverEnter",e,[E.content],function(){if(!t())throw T})},e.onHoverLeave=function(e){Ae("appButtonHoverLeave",e,[E.content],function(){if(!t())throw T})},e.isSupported=t}(e.appButton||(e.appButton={})),function(e){function t(){return!(!ge($)||!$.supports.pages||!$.supports.pages.currentApp)}e.navigateTo=function(e){return new Promise(function(n){if(ge($,E.content,E.sidePanel,E.settings,E.task,E.stage,E.meetingStage),!t())throw T;n(Be("pages.currentApp.navigateTo",e))})},e.navigateToDefaultPage=function(){return new Promise(function(e){if(ge($,E.content,E.sidePanel,E.settings,E.task,E.stage,E.meetingStage),!t())throw T;e(Be("pages.currentApp.navigateToDefaultPage"))})},e.isSupported=t}(e.currentApp||(e.currentApp={}))}(fe||(fe={}));var De=function(e,t,n){if(n||2===arguments.length)for(var a,i=0,r=t.length;i<r;i++)!a&&i in t||(a||(a=Array.prototype.slice.call(t,0,i)),a[i]=t[i]);return e.concat(a||Array.prototype.slice.call(t))},Ie=p("handlers"),xe=function(){function e(){}return e.handlers={},e}(),Ce=Ie.extend("callHandler");function Oe(e,t){var n=xe.handlers[e];return n?(Ce("Invoking the registered handler for message %s with arguments %o",e,t),[!0,n.apply(this,t)]):Ue.childWindow?(ot(e,t),[!1,void 0]):(Ce("Handler for action message %s not found.",e),[!1,void 0])}function we(e,t,n,a){void 0===n&&(n=!0),void 0===a&&(a=[]),t?(xe.handlers[e]=t,n&&Ve("registerHandler",De([e],a,!0))):delete xe.handlers[e]}function Ee(e){delete xe.handlers[e]}function Ae(e,t,n,a){t&&ge.apply(void 0,De([$],n,!1)),a&&a(),we(e,t)}function Le(e){xe.themeChangeHandler&&xe.themeChangeHandler(e),Ue.childWindow&&ot("themeChange",[e])}function ke(e){xe.loadHandler&&xe.loadHandler(e),Ue.childWindow&&ot("load",[e])}function Me(){var e=function(){Ve("readyToUnload",[])};xe.beforeUnloadHandler&&xe.beforeUnloadHandler(e)||(Ue.childWindow?ot("beforeUnload"):e())}var Pe=function(e,t,n){if(n||2===arguments.length)for(var a,i=0,r=t.length;i<r;i++)!a&&i in t||(a||(a=Array.prototype.slice.call(t,0,i)),a[i]=t[i]);return e.concat(a||Array.prototype.slice.call(t))},Te=p("communication"),Ue=function(){},Fe=function(){function e(){}return e.parentMessageQueue=[],e.childMessageQueue=[],e.nextMessageId=0,e.callbacks={},e.promiseCallbacks={},e}();function He(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return je(e,t).then(function(e){return e[0]})}function Re(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return je(e,t).then(function(e){var t=e[0],n=e[1];if(!t)throw new Error(n)})}function Ne(e,t){for(var n=[],a=2;a<arguments.length;a++)n[a-2]=arguments[a];return je(e,n).then(function(e){var n=e[0],a=e[1];if(!n)throw new Error(a||t)})}function Be(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return je(e,t).then(function(e){var t=e[0],n=e[1];if(t)throw t;return n})}function je(e,t){return void 0===t&&(t=void 0),new Promise(function(n){n(function(e){return new Promise(function(t){Fe.promiseCallbacks[e]=t})}(Ge(e,t).id))})}function Ve(e,t,n){var a;t instanceof Function?n=t:t instanceof Array&&(a=t);var i=Ge(e,a);n&&(Fe.callbacks[i.id]=n)}var ze=Te.extend("sendMessageToParentHelper");function Ge(e,t){var n=ze,a=Ue.parentWindow,i=function(e,t){return{id:Fe.nextMessageId++,func:e,timestamp:Date.now(),args:t||[]}}(e,t);if(n("Message %i information: %o",i.id,{actionName:e,args:t}),u.isFramelessWindow)Ue.currentWindow&&Ue.currentWindow.nativeInterface&&(n("Sending message %i to parent via framelessPostMessage interface",i.id),Ue.currentWindow.nativeInterface.framelessPostMessage(JSON.stringify(i)));else{var r=Je(a);a&&r?(n("Sending message %i to parent via postMessage",i.id),a.postMessage(i,r)):(n("Adding message %i to parent message queue",i.id),Ye(a).push(i))}return i}var Ke=Te.extend("processMessage"),We=Te.extend("shouldProcessMessage"),qe=Te.extend("handleParentMessage");function Qe(e){var t=qe;if("id"in e.data&&"number"==typeof e.data.id){var n=e.data,a=Fe.callbacks[n.id];t("Received a response from parent for message %i",n.id),a&&(t("Invoking the registered callback for message %i with arguments %o",n.id,n.args),a.apply(null,Pe(Pe([],n.args,!0),[n.isPartialResponse],!1)),function(e){return!0===e.data.isPartialResponse}(e)||(t("Removing registered callback for message %i",n.id),delete Fe.callbacks[n.id]));var i=Fe.promiseCallbacks[n.id];i&&(t("Invoking the registered promise callback for message %i with arguments %o",n.id,n.args),i(n.args),t("Removing registered promise callback for message %i",n.id),delete Fe.promiseCallbacks[n.id])}else"func"in e.data&&"string"==typeof e.data.func?(t("Received an action message %s from parent",(n=e.data).func),Oe(n.func,n.args)):t("Received an unknown message: %O",e)}function Ye(e){return e===Ue.parentWindow?Fe.parentMessageQueue:e===Ue.childWindow?Fe.childMessageQueue:[]}function Je(e){return e===Ue.parentWindow?Ue.parentOrigin:e===Ue.childWindow?Ue.childOrigin:null}var Xe,Ze,$e,et,tt,nt=Te.extend("flushMessageQueue");function at(e){for(var t=Je(e),n=Ye(e),a=e==Ue.parentWindow?"parent":"child";e&&t&&n.length>0;){var i=n.shift();nt("Flushing message %i from "+a+" message queue via postMessage.",i.id),e.postMessage(i,t)}}function it(e,t){var n=Ue.currentWindow.setInterval(function(){0===Ye(e).length&&(clearInterval(n),t())},100)}function rt(e,t,n){var a=Ue.childWindow,i=function(e,t,n){return{id:e,args:t||[],isPartialResponse:n}}(e,t,n),r=Je(a);a&&r&&a.postMessage(i,r)}function ot(e,t){var n=Ue.childWindow,a=function(e,t){return{func:e,args:t||[]}}(e,t),i=Je(n);n&&i?n.postMessage(a,i):Ye(n).push(a)}function st(e,t){ge($),Ve("uploadCustomApp",[e],t||R())}function ct(e,t,n){ge($),Ve(e,t,n)}function dt(e,t){if(ge($),!Ue.childWindow)throw new Error("The child window has not yet been initialized or is not present");ot(e,t)}function lt(e,t){var n=this;ge($),we(e,function(){for(var e=[],a=0;a<arguments.length;a++)e[a]=arguments[a];return t.apply(n,e)})}function ut(e,t){ge($),we("userSettingsChange",t,!0,[e])}function ft(e){ge($,E.content,E.task),Ve("openFilePreview",[e.entityId,e.title,e.description,e.type,e.objectUrl,e.downloadUrl,e.webPreviewUrl,e.webEditUrl,e.baseUrl,e.editFile,e.subEntityId,e.viewerAction,e.fileOpenPreference,e.conversationId])}!function(e){function t(){return!(!ge($)||!$.supports.logs)}e.registerGetLogHandler=function(e){if(e&&ge($),e&&!t())throw T;e?we("log.request",function(){Ve("log.receive",[e()])}):Ee("log.request")},e.isSupported=t}(Xe||(Xe={})),function(e){e.fileDownloadStart="fileDownloadStart",e.fileDownloadComplete="fileDownloadComplete"}(Ze||(Ze={})),function(e){e.view="view",e.edit="edit",e.editNew="editNew"}($e||($e={})),function(e){e.fileOpenPreference="fileOpenPreference",e.theme="theme"}(et||(et={})),function(e){function t(){return!(!ge($)||!$.supports.conversations)}e.openConversation=function(e){return new Promise(function(n){if(ge($,E.content),!t())throw T;var a=Re("conversations.openConversation",{title:e.title,subEntityId:e.subEntityId,conversationId:e.conversationId,channelId:e.channelId,entityId:e.entityId});e.onStartConversation&&we("startConversation",function(t,n,a,i){return e.onStartConversation({subEntityId:t,conversationId:n,channelId:a,entityId:i})}),e.onCloseConversation&&we("closeConversation",function(t,n,a,i){return e.onCloseConversation({subEntityId:t,conversationId:n,channelId:a,entityId:i})}),n(a)})},e.closeConversation=function(){if(ge($,E.content),!t())throw T;Ve("conversations.closeConversation"),Ee("startConversation"),Ee("closeConversation")},e.getChatMembers=function(){return new Promise(function(e){if(ge($),!t())throw T;e(He("getChatMembers"))})},e.isSupported=t}(tt||(tt={}));var pt,mt="users";function _t(e,t,n){if(0===e.length)throw new Error("Must have at least one user when creating a chat deep link");var a="".concat(mt,"=")+e.map(function(e){return encodeURIComponent(e)}).join(","),i=void 0===t?"":"&".concat("topicName","=").concat(encodeURIComponent(t)),r=void 0===n?"":"&".concat("message","=").concat(encodeURIComponent(n));return"".concat(c,"://").concat(d).concat("/l/chat/0/0","?").concat(a).concat(i).concat(r)}!function(e){function t(){return!(!ge($)||!$.supports.appInstallDialog)}e.openAppInstallDialog=function(e){return new Promise(function(n){if(ge($,E.content,E.sidePanel,E.settings,E.task,E.stage,E.meetingStage),!t())throw new Error("Not supported");$.isLegacyTeams?n(Re("executeDeepLink",function(e){if(!e)throw new Error("App ID must be set when creating an app install dialog deep link");return"".concat(c,"://").concat(d).concat("/l/app/").concat(encodeURIComponent(e))}(e.appId))):(Ve("appInstallDialog.openAppInstallDialog",[e]),n())})},e.isSupported=t}(pt||(pt={}));var ht,bt,gt,vt=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}();function yt(e,t){if(null==e||null==t||e.length<=0)return null;var n,a=1;return e.sort(function(e,t){return e.sequence>t.sequence?1:-1}),e.forEach(function(e){e.sequence==a&&(n=n?new Blob([n,e.file],{type:t}):new Blob([e.file],{type:t}),a++)}),n}function St(e,t){if(null==e||null==t)return null;for(var n=atob(e.chunk),a=new Array(n.length),i=0;i<n.length;i++)a[i]=n.charCodeAt(i);var r=new Uint8Array(a),o=new Blob([r],{type:t});return{sequence:e.chunkSequence,file:o}}function Dt(e){!function(e){return!(!e||e.mediaType!=ht.MediaType.VideoAndImage&&!e.videoAndImageProps)}(e)?function(e){return!(!e||e.mediaType!=ht.MediaType.Video||!e.videoProps||e.videoProps.isFullScreenMode)}(e)?Se(t):function(e){var t;return!((null==e?void 0:e.mediaType)!=ht.MediaType.Image||!(null===(t=null==e?void 0:e.imageProps)||void 0===t?void 0:t.imageOutputFormats))}(e)&&Se("2.0.4"):Se("2.0.2")}function It(e){return!e||!(null===e.timeOutIntervalInSec||e.timeOutIntervalInSec<=0||e.timeOutIntervalInSec>60)}!function(e){!function(e){e.Base64="base64",e.ID="id"}(e.FileFormat||(e.FileFormat={}));var n=function(){};function a(){return!(!ge($)||!$.supports.permissions)}e.File=n,e.captureImage=function(e){if(!e)throw new Error("[captureImage] Callback cannot be null");ge($,E.content,E.task),u.isFramelessWindow?ve("1.7.0")?Ve("captureImage",e):e({errorCode:I.OLD_PLATFORM},void 0):e({errorCode:I.NOT_SUPPORTED_ON_PLATFORM},void 0)},e.hasPermission=function(){if(ge($,E.content,E.task),!a())throw T;var e=x.Media;return new Promise(function(t){t(Be("permissions.has",e))})},e.requestPermission=function(){if(ge($,E.content,E.task),!a())throw T;var e=x.Media;return new Promise(function(t){t(Be("permissions.request",e))})};var i=function(e){function t(t){void 0===t&&(t=null);var n=e.call(this)||this;return t&&(n.content=t.content,n.format=t.format,n.mimeType=t.mimeType,n.name=t.name,n.preview=t.preview,n.size=t.size),n}return vt(t,e),t.prototype.getMedia=function(e){if(!e)throw new Error("[get Media] Callback cannot be null");ge($,E.content,E.task),ve(r)?function(e,t,n){return null!=e&&null!=t&&t==ht.FileFormat.ID&&null!=n}(this.mimeType,this.format,this.content)?ve("2.0.0")?this.getMediaViaCallback(e):this.getMediaViaHandler(e):e({errorCode:I.INVALID_ARGUMENTS},null):e({errorCode:I.OLD_PLATFORM},null)},t.prototype.getMediaViaCallback=function(e){var t={mediaMimeType:this.mimeType,assembleAttachment:[]};Ve("getMedia",[this.content],function(n){if(e)if(n&&n.error)e(n.error,null);else if(n&&n.mediaChunk)if(n.mediaChunk.chunkSequence<=0){var a=yt(t.assembleAttachment,t.mediaMimeType);e(n.error,a)}else{var i=St(n.mediaChunk,t.mediaMimeType);t.assembleAttachment.push(i)}else e({errorCode:I.INTERNAL_ERROR,message:"data received is null"},null)})},t.prototype.getMediaViaHandler=function(e){var t=B(),n={mediaMimeType:this.mimeType,assembleAttachment:[]},a=[t,this.content];this.content&&e&&Ve("getMedia",a),we("getMedia"+t,function(a){if(e){var i=JSON.parse(a);if(i.error)e(i.error,null),Ee("getMedia"+t);else if(i.mediaChunk)if(i.mediaChunk.chunkSequence<=0){var r=yt(n.assembleAttachment,n.mediaMimeType);e(i.error,r),Ee("getMedia"+t)}else{var o=St(i.mediaChunk,n.mediaMimeType);n.assembleAttachment.push(o)}else e({errorCode:I.INTERNAL_ERROR,message:"data received is null"},null),Ee("getMedia"+t)}})},t}(n);e.Media=i;var o,s,c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return vt(t,e),t.prototype.getMediaType=function(){return s.Video},t.prototype.notifyEventToApp=function(e){if(this.controllerCallback)switch(e){case o.StartRecording:if(this.controllerCallback.onRecordingStarted){this.controllerCallback.onRecordingStarted();break}}},t}(function(){function e(e){this.controllerCallback=e}return e.prototype.notifyEventToHost=function(e,n){ge($,E.content,E.task);try{Se(t)}catch(e){return void(n&&n(e))}Ve("media.controller",[{mediaType:this.getMediaType(),mediaControllerEvent:e}],function(e){n&&n(e)})},e.prototype.stop=function(e){this.notifyEventToHost(o.StopRecording,e)},e}());e.VideoController=c,function(e){e[e.StartRecording=1]="StartRecording",e[e.StopRecording=2]="StopRecording"}(o=e.MediaControllerEvent||(e.MediaControllerEvent={})),function(e){e[e.Photo=1]="Photo",e[e.Document=2]="Document",e[e.Whiteboard=3]="Whiteboard",e[e.BusinessCard=4]="BusinessCard"}(e.CameraStartMode||(e.CameraStartMode={})),function(e){e[e.Camera=1]="Camera",e[e.Gallery=2]="Gallery"}(e.Source||(e.Source={})),function(e){e[e.Image=1]="Image",e[e.Video=2]="Video",e[e.VideoAndImage=3]="VideoAndImage",e[e.Audio=4]="Audio"}(s=e.MediaType||(e.MediaType={})),function(e){e[e.ID=1]="ID",e[e.URL=2]="URL"}(e.ImageUriType||(e.ImageUriType={})),function(e){e[e.IMAGE=1]="IMAGE",e[e.PDF=2]="PDF"}(e.ImageOutputFormats||(e.ImageOutputFormats={})),e.selectMedia=function(e,t){if(!t)throw new Error("[select Media] Callback cannot be null");if(ge($,E.content,E.task),ve(r)){try{Dt(e)}catch(e){return void t(e,null)}if(function(e){return!(null==e||e.maxMediaCount>10)}(e))Ve("selectMedia",[e],function(n,a,r){if(r)(function(e){return!(e.mediaType!=ht.MediaType.Video||!e.videoProps||!e.videoProps.videoController)})(e)&&e.videoProps.videoController.notifyEventToApp(r);else if(a){for(var o=[],s=0,c=a;s<c.length;s++){var d=c[s];o.push(new i(d))}t(n,o)}else t(n,null)});else{var n={errorCode:I.INVALID_ARGUMENTS};t(n,null)}}else{var a={errorCode:I.OLD_PLATFORM};t(a,null)}},e.viewImages=function(e,t){if(!t)throw new Error("[view images] Callback cannot be null");ge($,E.content,E.task),ve(r)?function(e){return!(null==e||e.length<=0||e.length>10)}(e)?Ve("viewImages",[e],t):t({errorCode:I.INVALID_ARGUMENTS}):t({errorCode:I.OLD_PLATFORM})},e.scanBarCode=function(e,t){if(!e)throw new Error("[media.scanBarCode] Callback cannot be null");ge($,E.content,E.task),u.hostClientType!==O.desktop&&u.hostClientType!==O.web&&u.hostClientType!==O.rigel&&u.hostClientType!==O.teamsRoomsWindows&&u.hostClientType!==O.teamsRoomsAndroid&&u.hostClientType!==O.teamsPhones&&u.hostClientType!==O.teamsDisplays?ve("1.9.0")?It(t)?Ve("media.scanBarCode",[t],e):e({errorCode:I.INVALID_ARGUMENTS},null):e({errorCode:I.OLD_PLATFORM},null):e({errorCode:I.NOT_SUPPORTED_ON_PLATFORM},null)}}(ht||(ht={})),function(e){function t(){return!!(ge($)&&$.supports.barCode&&$.supports.permissions)}e.scanBarCode=function(e){return new Promise(function(n){if(ge($,E.content,E.task),!t())throw T;if(!It(e))throw{errorCode:I.INVALID_ARGUMENTS};n(Be("media.scanBarCode",e))})},e.hasPermission=function(){if(ge($,E.content,E.task),!t())throw T;var e=x.Media;return new Promise(function(t){t(Be("permissions.has",e))})},e.requestPermission=function(){if(ge($,E.content,E.task),!t())throw T;var e=x.Media;return new Promise(function(t){t(Be("permissions.request",e))})},e.isSupported=t}(bt||(bt={})),function(e){function t(e){return new Promise(function(t){if(ge($,E.content,E.task),!n())throw T;$.isLegacyTeams?t(Re("executeDeepLink",_t([e.user],void 0,e.message))):t(Re("chat.openChat",{members:e.user,message:e.message}))})}function n(){return!(!ge($)||!$.supports.chat)}e.openChat=t,e.openGroupChat=function(e){return new Promise(function(a){if(e.users.length<1)throw Error("OpenGroupChat Failed: No users specified");if(1===e.users.length)t({user:e.users[0],message:e.message});else{if(ge($,E.content,E.task),!n())throw T;$.isLegacyTeams?a(Re("executeDeepLink",_t(e.users,e.topic,e.message))):a(Re("chat.openChat",{members:e.users,message:e.message,topic:e.topic}))}})},e.isSupported=n}(gt||(gt={}));var xt,Ct,Ot=function(e,t,n,a){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(n,r){function o(e){try{c(a.next(e))}catch(e){r(e)}}function s(e){try{c(a.throw(e))}catch(e){r(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((a=a.apply(e,t||[])).next())})},wt=function(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(e){return function(t){return c([e,t])}}function c(s){if(n)throw new TypeError("Generator is already executing.");for(;r&&(r=0,s[0]&&(o=0)),o;)try{if(n=1,a&&(i=2&s[0]?a.return:s[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,s[1])).done)return i;switch(a=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,a=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],a=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}};function Et(){return $.hostVersionsInfo?$.hostVersionsInfo.adaptiveCardSchemaVersion:void 0}!function(e){function t(){return!!(ge($)&&navigator&&navigator.clipboard&&$.supports.clipboard)}e.write=function(e){return Ot(this,void 0,void 0,function(){var n;return wt(this,function(a){switch(a.label){case 0:if(ge($,E.content,E.task,E.stage,E.sidePanel),!t())throw T;if(!e.type||!Object.values(C).includes(e.type))throw new Error("Blob type ".concat(e.type," is not supported. Supported blob types are ").concat(Object.values(C)));return[4,W(e)];case 1:return n=a.sent(),[2,Be("clipboard.writeToClipboard",{mimeType:e.type,content:n})]}})})},e.read=function(){return Ot(this,void 0,void 0,function(){var e,n,a;return wt(this,function(i){switch(i.label){case 0:if(ge($,E.content,E.task,E.stage,E.sidePanel),!t())throw T;return ye()||u.hostClientType===O.macos?(a=(n=JSON).parse,[4,Be("clipboard.readFromClipboard")]):[3,2];case 1:return[2,K((e=a.apply(n,[i.sent()])).mimeType,e.content)];case 2:return[2,Be("clipboard.readFromClipboard")]}})})},e.isSupported=t}(xt||(xt={})),function(e){function t(){return!!(ge($)&&$.supports.geoLocation&&$.supports.permissions)}e.getCurrentLocation=function(){if(ge($,E.content,E.task),!t())throw T;return Be("location.getLocation",{allowChooseLocation:!1,showMap:!1})},e.hasPermission=function(){if(ge($,E.content,E.task),!t())throw T;var e=x.GeoLocation;return new Promise(function(t){t(Be("permissions.has",e))})},e.requestPermission=function(){if(ge($,E.content,E.task),!t())throw T;var e=x.GeoLocation;return new Promise(function(t){t(Be("permissions.request",e))})},e.isSupported=t,function(e){function t(){return!!(ge($)&&$.supports.geoLocation&&$.supports.geoLocation.map&&$.supports.permissions)}e.chooseLocation=function(){if(ge($,E.content,E.task),!t())throw T;return Be("location.getLocation",{allowChooseLocation:!0,showMap:!0})},e.showLocation=function(e){if(ge($,E.content,E.task),!t())throw T;if(!e)throw{errorCode:I.INVALID_ARGUMENTS};return Be("location.showLocation",e)},e.isSupported=t}(e.map||(e.map={}))}(Ct||(Ct={}));var At,Lt,kt,Mt,Pt,Tt,Ut,Ft,Ht=function(){function e(){}return e.prototype.postMessage=function(e,t){ge($),Ve("messageForChild",[e],t||R())},e.prototype.addEventListener=function(e,t){ge($),"message"===e&&we("messageForParent",t)},e}(),Rt=function(){function e(){}return Object.defineProperty(e,"Instance",{get:function(){return this._instance||(this._instance=new this)},enumerable:!1,configurable:!0}),e.prototype.postMessage=function(e,t){ge($,E.task),Ve("messageForParent",[e],t||R())},e.prototype.addEventListener=function(e,t){ge($,E.task),"message"===e&&we("messageForChild",t)},e}();!function(e){function t(){return!(!ge($)||!$.supports.secondaryBrowser)}e.open=function(e){if(ge($,E.content),!t())throw T;if(!e||!G(e))throw{errorCode:I.INVALID_ARGUMENTS,message:"Invalid Url: Only https URL is allowed"};return Be("secondaryBrowser.open",e.toString())},e.isSupported=t}(At||(At={})),function(e){function t(){return!(!ge($)||!$.supports.location)}e.getLocation=function(e,a){if(!a)throw new Error("[location.getLocation] Callback cannot be null");if(ge($,E.content,E.task),!ve(n))throw{errorCode:I.OLD_PLATFORM};if(!e)throw{errorCode:I.INVALID_ARGUMENTS};if(!t())throw T;Ve("location.getLocation",[e],a)},e.showLocation=function(e,a){if(!a)throw new Error("[location.showLocation] Callback cannot be null");if(ge($,E.content,E.task),!ve(n))throw{errorCode:I.OLD_PLATFORM};if(!e)throw{errorCode:I.INVALID_ARGUMENTS};if(!t())throw T;Ve("location.showLocation",[e],a)},e.isSupported=t}(Lt||(Lt={})),function(e){var t;function n(e,n){var i=this;Ve("meeting.requestAppAudioHandling",[e.isAppHandlingAudio],function(r,o){if(r&&null!=o)throw new Error("[requestAppAudioHandling] Callback response - both parameters cannot be set");if(r)throw new Error("[requestAppAudioHandling] Callback response - SDK error ".concat(r.errorCode," ").concat(r.message));if("boolean"!=typeof o)throw new Error("[requestAppAudioHandling] Callback response - isHostAudioless must be a boolean");we("meeting.micStateChanged",function(n){return function(e,t,n,a){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(t,n){function r(e){try{s(a.next(e))}catch(e){n(e)}}function o(e){try{s(a.throw(e))}catch(e){n(e)}}function s(e){e.done?t(e.value):i(e.value).then(r,o)}s((a=a.apply(e,[])).next())})}(i,0,void 0,function(){var i,r;return function(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(e){return function(t){return c([e,t])}}function c(s){if(n)throw new TypeError("Generator is already executing.");for(;r&&(r=0,s[0]&&(o=0)),o;)try{if(n=1,a&&(i=2&s[0]?a.return:s[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,s[1])).done)return i;switch(a=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,a=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],a=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}}(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,e.micMuteStateChangedCallback(n)];case 1:return i=o.sent(),r=i.isMicMuted===n.isMicMuted,a(i,r?t.HostInitiated:t.AppDeclinedToChange),[3,3];case 2:return o.sent(),a(n,t.AppFailedToChange),[3,3];case 3:return[2]}})})}),n(o)})}function a(e,t){ge($,E.sidePanel,E.meetingStage),Ve("meeting.updateMicState",[e,t])}!function(e){e[e.HostInitiated=0]="HostInitiated",e[e.AppInitiated=1]="AppInitiated",e[e.AppDeclinedToChange=2]="AppDeclinedToChange",e[e.AppFailedToChange=3]="AppFailedToChange"}(t||(t={})),function(e){e.like="like",e.heart="heart",e.laugh="laugh",e.surprised="surprised",e.applause="applause"}(e.MeetingReactionType||(e.MeetingReactionType={})),function(e){e.Unknown="Unknown",e.Adhoc="Adhoc",e.Scheduled="Scheduled",e.Recurring="Recurring",e.Broadcast="Broadcast",e.MeetNow="MeetNow"}(e.MeetingType||(e.MeetingType={})),function(e){e.OneOnOneCall="oneOnOneCall",e.GroupCall="groupCall"}(e.CallType||(e.CallType={})),e.getIncomingClientAudioState=function(e){if(!e)throw new Error("[get incoming client audio state] Callback cannot be null");ge($,E.sidePanel,E.meetingStage),Ve("getIncomingClientAudioState",e)},e.toggleIncomingClientAudio=function(e){if(!e)throw new Error("[toggle incoming client audio] Callback cannot be null");ge($,E.sidePanel,E.meetingStage),Ve("toggleIncomingClientAudio",e)},e.getMeetingDetails=function(e){if(!e)throw new Error("[get meeting details] Callback cannot be null");ge($,E.sidePanel,E.meetingStage,E.settings,E.content),Ve("meeting.getMeetingDetails",e)},e.getAuthenticationTokenForAnonymousUser=function(e){if(!e)throw new Error("[get Authentication Token For AnonymousUser] Callback cannot be null");ge($,E.sidePanel,E.meetingStage,E.task),Ve("meeting.getAuthenticationTokenForAnonymousUser",e)},e.getLiveStreamState=function(e){if(!e)throw new Error("[get live stream state] Callback cannot be null");ge($,E.sidePanel),Ve("meeting.getLiveStreamState",e)},e.requestStartLiveStreaming=function(e,t,n){if(!e)throw new Error("[request start live streaming] Callback cannot be null");ge($,E.sidePanel),Ve("meeting.requestStartLiveStreaming",[t,n],e)},e.requestStopLiveStreaming=function(e){if(!e)throw new Error("[request stop live streaming] Callback cannot be null");ge($,E.sidePanel),Ve("meeting.requestStopLiveStreaming",e)},e.registerLiveStreamChangedHandler=function(e){if(!e)throw new Error("[register live stream changed handler] Handler cannot be null");ge($,E.sidePanel),we("meeting.liveStreamChanged",e)},e.shareAppContentToStage=function(e,t){if(!e)throw new Error("[share app content to stage] Callback cannot be null");ge($,E.sidePanel,E.meetingStage),Ve("meeting.shareAppContentToStage",[t],e)},e.getAppContentStageSharingCapabilities=function(e){if(!e)throw new Error("[get app content stage sharing capabilities] Callback cannot be null");ge($,E.sidePanel,E.meetingStage),Ve("meeting.getAppContentStageSharingCapabilities",e)},e.stopSharingAppContentToStage=function(e){if(!e)throw new Error("[stop sharing app content to stage] Callback cannot be null");ge($,E.sidePanel,E.meetingStage),Ve("meeting.stopSharingAppContentToStage",e)},e.getAppContentStageSharingState=function(e){if(!e)throw new Error("[get app content stage sharing state] Callback cannot be null");ge($,E.sidePanel,E.meetingStage),Ve("meeting.getAppContentStageSharingState",e)},e.registerSpeakingStateChangeHandler=function(e){if(!e)throw new Error("[registerSpeakingStateChangeHandler] Handler cannot be null");ge($,E.sidePanel,E.meetingStage),we("meeting.speakingStateChanged",e)},e.registerRaiseHandStateChangedHandler=function(e){if(!e)throw new Error("[registerRaiseHandStateChangedHandler] Handler cannot be null");ge($,E.sidePanel,E.meetingStage),we("meeting.raiseHandStateChanged",e)},e.registerMeetingReactionReceivedHandler=function(e){if(!e)throw new Error("[registerMeetingReactionReceivedHandler] Handler cannot be null");ge($,E.sidePanel,E.meetingStage),we("meeting.meetingReactionReceived",e)},function(e){e.setOptions=function(e){ge($,E.sidePanel),e.contentUrl&&new URL(e.contentUrl),Ve("meeting.appShareButton.setOptions",[e])}}(e.appShareButton||(e.appShareButton={})),e.requestAppAudioHandling=function(e,t){if(!t)throw new Error("[requestAppAudioHandling] Callback response cannot be null");if(!e.micMuteStateChangedCallback)throw new Error("[requestAppAudioHandling] Callback Mic mute state handler cannot be null");ge($,E.sidePanel,E.meetingStage),e.isAppHandlingAudio?n(e,t):function(e,t){Ve("meeting.requestAppAudioHandling",[e.isAppHandlingAudio],function(e,n){if(e&&null!=n)throw new Error("[requestAppAudioHandling] Callback response - both parameters cannot be set");if(e)throw new Error("[requestAppAudioHandling] Callback response - SDK error ".concat(e.errorCode," ").concat(e.message));if("boolean"!=typeof n)throw new Error("[requestAppAudioHandling] Callback response - isHostAudioless must be a boolean");null!=xe.handlers["meeting.micStateChanged"]&&Ee("meeting.micStateChanged"),t(n)})}(e,t)},e.updateMicState=function(e){a(e,t.AppInitiated)}}(kt||(kt={})),function(e){function t(){return!(!ge($)||!$.supports.monetization)}e.openPurchaseExperience=function(e,n){var a,i;return"function"==typeof e?(a=e,i=n):i=e,ge($,E.content),function(e,t){for(var n=[],a=2;a<arguments.length;a++)n[a-2]=arguments[a];var i=e.apply(void 0,n);return i.then(function(e){t&&t(null,e)}).catch(function(e){t&&t(e,null)}),i}(function(){return new Promise(function(e){if(!t())throw T;e(Be("monetization.openPurchaseExperience",i))})},a)},e.isSupported=t}(Mt||(Mt={})),function(e){function t(){return!(!ge($)||!$.supports.calendar)}e.openCalendarItem=function(e){return new Promise(function(n){if(ge($,E.content),!t())throw new Error("Not supported");if(!e.itemId||!e.itemId.trim())throw new Error("Must supply an itemId to openCalendarItem");n(Re("calendar.openCalendarItem",e))})},e.composeMeeting=function(e){return new Promise(function(n){if(ge($,E.content),!t())throw new Error("Not supported");$.isLegacyTeams?n(Re("executeDeepLink",function(e,t,n,a,i){var r=void 0===e?"":"".concat("attendees","=")+e.map(function(e){return encodeURIComponent(e)}).join(","),o=void 0===t?"":"&".concat("startTime","=").concat(encodeURIComponent(t)),s=void 0===n?"":"&".concat("endTime","=").concat(encodeURIComponent(n)),l=void 0===a?"":"&".concat("subject","=").concat(encodeURIComponent(a)),u=void 0===i?"":"&".concat("content","=").concat(encodeURIComponent(i));return"".concat(c,"://").concat(d).concat("/l/meeting/new","?").concat(r).concat(o).concat(s).concat(l).concat(u)}(e.attendees,e.startTime,e.endTime,e.subject,e.content))):n(Re("calendar.composeMeeting",e))})},e.isSupported=t}(Pt||(Pt={})),function(e){function t(){return!(!ge($)||!$.supports.mail)}e.openMailItem=function(e){return new Promise(function(n){if(ge($,E.content),!t())throw new Error("Not supported");if(!e.itemId||!e.itemId.trim())throw new Error("Must supply an itemId to openMailItem");n(Re("mail.openMailItem",e))})},e.composeMail=function(e){return new Promise(function(n){if(ge($,E.content),!t())throw new Error("Not supported");n(Re("mail.composeMail",e))})},e.isSupported=t,function(e){e.New="new",e.Reply="reply",e.ReplyAll="replyAll",e.Forward="forward"}(e.ComposeMailType||(e.ComposeMailType={}))}(Tt||(Tt={})),function(e){function t(e){return new Promise(function(t){if(!ve("2.0.0"))throw{errorCode:I.OLD_PLATFORM};if(!function(e){if(e){if(e.title&&"string"!=typeof e.title)return!1;if(e.setSelected&&"object"!=typeof e.setSelected)return!1;if(e.openOrgWideSearchInChatOrChannel&&"boolean"!=typeof e.openOrgWideSearchInChatOrChannel)return!1;if(e.singleSelect&&"boolean"!=typeof e.singleSelect)return!1}return!0}(e))throw{errorCode:I.INVALID_ARGUMENTS};if(!n())throw T;t(Be("people.selectPeople",e))})}function n(){return!(!ge($)||!$.supports.people)}e.selectPeople=function(e,n){var a,i,r;return ge($,E.content,E.task,E.settings),"function"==typeof e?(i=(a=[e,n])[0],r=a[1]):r=e,function(e,t){for(var n=[],a=2;a<arguments.length;a++)n[a-2]=arguments[a];var i=e.apply(void 0,n);return i.then(function(e){t&&t(void 0,e)}).catch(function(e){t&&t(e)}),i}(t,i,r)},e.isSupported=n}(Ut||(Ut={})),function(e){e.showProfile=function(e){return ge($,E.content),new Promise(function(t){var n=function(e){return e?e.modality&&"string"!=typeof e.modality?[!1,"modality must be a string"]:e.targetElementBoundingRect&&"object"==typeof e.targetElementBoundingRect?e.triggerType&&"string"==typeof e.triggerType?function(e){return e?e.displayName&&"string"!=typeof e.displayName?[!1,"displayName must be a string"]:e.identifiers&&"object"==typeof e.identifiers?e.identifiers.AadObjectId||e.identifiers.Smtp||e.identifiers.Upn?e.identifiers.AadObjectId&&"string"!=typeof e.identifiers.AadObjectId?[!1,"AadObjectId identifier must be a string"]:e.identifiers.Smtp&&"string"!=typeof e.identifiers.Smtp?[!1,"Smtp identifier must be a string"]:e.identifiers.Upn&&"string"!=typeof e.identifiers.Upn?[!1,"Upn identifier must be a string"]:[!0,void 0]:[!1,"at least one valid identifier must be provided"]:[!1,"persona identifiers object must be provided"]:[!1,"persona object must be provided"]}(e.persona):[!1,"triggerType must be a valid string"]:[!1,"targetElementBoundingRect must be a DOMRect"]:[!1,"A request object is required"]}(e),a=n[0],i=n[1];if(!a)throw{errorCode:I.INVALID_ARGUMENTS,message:i};t(Be("profile.showProfile",{modality:e.modality,persona:e.persona,triggerType:e.triggerType,targetRectangle:{x:e.targetElementBoundingRect.x,y:e.targetElementBoundingRect.y,width:e.targetElementBoundingRect.width,height:e.targetElementBoundingRect.height}}))})},e.isSupported=function(){return!(!ge($)||!$.supports.profile)}}(Ft||(Ft={}));var Nt,Bt=function(){function e(){}return e.setTimeout=function(t,n){var a=performance.now(),i=B();return e.setTimeoutCallbacks[i]={callback:t,timeoutInMs:n,startedAtInMs:a},i},e.clearTimeout=function(t){delete e.setTimeoutCallbacks[t]},e.setInterval=function(t,n){e.setTimeout(function a(){t(),e.setTimeout(a,n)},n)},e.tick=function(){var t=performance.now(),n=[];for(var a in e.setTimeoutCallbacks)t-(o=e.setTimeoutCallbacks[a]).startedAtInMs>=o.timeoutInMs&&n.push(a);for(var i=0,r=n;i<r.length;i++){var o,s=r[i];(o=e.setTimeoutCallbacks[s]).callback(),delete e.setTimeoutCallbacks[s]}},e.setTimeoutCallbacks={},e}(),jt=function(){function e(e,t){this.reportStatisticsResult=t,this.sampleCount=0,this.distributionBins=new Uint32Array(e)}return e.prototype.processStarts=function(e,t,n,a){Bt.tick(),this.suitableForThisSession(e,t,n,a)||this.reportAndResetSession(this.getStatistics(),e,a,t,n),this.start()},e.prototype.processEnds=function(){var e=performance.now()-this.frameProcessingStartedAt,t=Math.floor(Math.max(0,Math.min(this.distributionBins.length-1,e)));this.distributionBins[t]+=1,this.sampleCount+=1},e.prototype.getStatistics=function(){return this.currentSession?{effectId:this.currentSession.effectId,effectParam:this.currentSession.effectParam,frameHeight:this.currentSession.frameHeight,frameWidth:this.currentSession.frameWidth,duration:performance.now()-this.currentSession.startedAtInMs,sampleCount:this.sampleCount,distributionBins:this.distributionBins.slice()}:null},e.prototype.start=function(){this.frameProcessingStartedAt=performance.now()},e.prototype.suitableForThisSession=function(e,t,n,a){return this.currentSession&&this.currentSession.effectId===e&&this.currentSession.effectParam===a&&this.currentSession.frameWidth===t&&this.currentSession.frameHeight===n},e.prototype.reportAndResetSession=function(e,t,n,a,i){var r=this;e&&this.reportStatisticsResult(e),this.resetCurrentSession(this.getNextTimeout(t,this.currentSession),t,n,a,i),this.timeoutId&&Bt.clearTimeout(this.timeoutId),this.timeoutId=Bt.setTimeout(function(){return r.reportAndResetSession(r.getStatistics(),t,n,a,i)}.bind(this),this.currentSession.timeoutInMs)},e.prototype.resetCurrentSession=function(e,t,n,a,i){this.currentSession={startedAtInMs:performance.now(),timeoutInMs:e,effectId:t,effectParam:n,frameWidth:a,frameHeight:i},this.sampleCount=0,this.distributionBins.fill(0)},e.prototype.getNextTimeout=function(t,n){return n&&n.effectId===t?Math.min(e.maxSessionTimeoutInMs,2*n.timeoutInMs):e.initialSessionTimeoutInMs},e.initialSessionTimeoutInMs=1e3,e.maxSessionTimeoutInMs=3e4,e}(),Vt=function(){function e(t){var n=this;this.reportPerformanceEvent=t,this.isFirstFrameProcessed=!1,this.frameProcessTimeLimit=100,this.frameProcessingStartedAt=0,this.frameProcessingTimeCost=0,this.processedFrameCount=0,this.performanceStatistics=new jt(e.distributionBinSize,function(e){return n.reportPerformanceEvent("video.performance.performanceDataGenerated",[e])})}return e.prototype.startMonitorSlowFrameProcessing=function(){var t=this;Bt.setInterval(function(){if(0!==t.processedFrameCount){var e=t.frameProcessingTimeCost/t.processedFrameCount;e>t.frameProcessTimeLimit&&t.reportPerformanceEvent("video.performance.frameProcessingSlow",[e]),t.frameProcessingTimeCost=0,t.processedFrameCount=0}},e.calculateFPSInterval)},e.prototype.setFrameProcessTimeLimit=function(e){this.frameProcessTimeLimit=e},e.prototype.reportApplyingVideoEffect=function(e,t){var n,a;(null===(n=this.applyingEffect)||void 0===n?void 0:n.effectId)===e&&(null===(a=this.applyingEffect)||void 0===a?void 0:a.effectParam)===t||(this.applyingEffect={effectId:e,effectParam:t},this.appliedEffect=void 0)},e.prototype.reportVideoEffectChanged=function(e,t){void 0===this.applyingEffect||this.applyingEffect.effectId!==e&&this.applyingEffect.effectParam!==t||(this.appliedEffect={effectId:e,effectParam:t},this.applyingEffect=void 0,this.isFirstFrameProcessed=!1)},e.prototype.reportStartFrameProcessing=function(e,t){Bt.tick(),this.appliedEffect&&(this.frameProcessingStartedAt=performance.now(),this.performanceStatistics.processStarts(this.appliedEffect.effectId,e,t,this.appliedEffect.effectParam))},e.prototype.reportFrameProcessed=function(){var e;this.appliedEffect&&(this.processedFrameCount++,this.frameProcessingTimeCost+=performance.now()-this.frameProcessingStartedAt,this.performanceStatistics.processEnds(),this.isFirstFrameProcessed||(this.isFirstFrameProcessed=!0,this.reportPerformanceEvent("video.performance.firstFrameProcessed",[Date.now(),this.appliedEffect.effectId,null===(e=this.appliedEffect)||void 0===e?void 0:e.effectParam])))},e.prototype.reportGettingTextureStream=function(e){this.gettingTextureStreamStartedAt=performance.now(),this.currentStreamId=e},e.prototype.reportTextureStreamAcquired=function(){if(void 0!==this.gettingTextureStreamStartedAt){var e=performance.now()-this.gettingTextureStreamStartedAt;this.reportPerformanceEvent("video.performance.textureStreamAcquired",[this.currentStreamId,e])}},e.distributionBinSize=1e3,e.calculateFPSInterval=1e3,e}(),zt=function(e,t,n,a){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(n,r){function o(e){try{c(a.next(e))}catch(e){r(e)}}function s(e){try{c(a.throw(e))}catch(e){r(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((a=a.apply(e,t||[])).next())})},Gt=function(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(e){return function(t){return c([e,t])}}function c(s){if(n)throw new TypeError("Generator is already executing.");for(;r&&(r=0,s[0]&&(o=0)),o;)try{if(n=1,a&&(i=2&s[0]?a.return:s[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,s[1])).done)return i;switch(a=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,a=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],a=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}};function Kt(e,t,n,a){var i,r;return zt(this,void 0,void 0,function(){var o,s;return Gt(this,function(c){switch(c.label){case 0:return o=Qt(),!Q()&&(null===(r=null===(i=window.chrome)||void 0===i?void 0:i.webview)||void 0===r||r.registerTextureStream(e,o)),s=Yt,[4,qt(e,n,a)];case 1:return s.apply(void 0,[c.sent(),new Jt(n,t),o.writable]),[2]}})})}function Wt(e,t,n,a){var i,r;return zt(this,void 0,void 0,function(){var o,s;return Gt(this,function(c){switch(c.label){case 0:return o=Qt(),!Q()&&(null===(r=null===(i=window.chrome)||void 0===i?void 0:i.webview)||void 0===r||r.registerTextureStream(e,o)),s=Yt,[4,qt(e,n,a)];case 1:return s.apply(void 0,[c.sent(),new $t(n,t),o.writable]),[2]}})})}function qt(e,t,n){return zt(this,void 0,void 0,function(){var a,i,r,o,s;return Gt(this,function(c){switch(c.label){case 0:if(Q())throw T;a=q().chrome,c.label=1;case 1:return c.trys.push([1,3,,4]),null==n||n.reportGettingTextureStream(e),[4,a.webview.getTextureStream(e)];case 2:if(i=c.sent(),0===(r=i.getVideoTracks()).length)throw new Error("No video track in stream ".concat(e));return null==n||n.reportTextureStreamAcquired(),[2,r[0]];case 3:throw o=c.sent(),s="Failed to get video track from stream ".concat(e,", error: ").concat(o),t(s),new Error("Internal error: can't get video track from stream ".concat(e));case 4:return[2]}})})}function Qt(){if(Q())throw T;var e=window.MediaStreamTrackGenerator;if(!e)throw T;return new e({kind:"video"})}function Yt(e,t,n){new(0,q().MediaStreamTrackProcessor)({track:e}).readable.pipeThrough(new TransformStream(t)).pipeTo(n)}!function(e){e.TimestampIsNull="timestamp of the original video frame is null",e.UnsupportedVideoFramePixelFormat="Unsupported video frame pixel format"}(Nt||(Nt={}));var Jt=function(e,t){var n=this;this.notifyError=e,this.videoFrameHandler=t,this.transform=function(e,t){return zt(n,void 0,void 0,function(){var n,a,i,r;return Gt(this,function(o){switch(o.label){case 0:if(null===(n=e.timestamp))return[3,5];o.label=1;case 1:return o.trys.push([1,3,,4]),[4,this.videoFrameHandler({videoFrame:e})];case 2:return a=o.sent(),i=new VideoFrame(a,{timestamp:n}),t.enqueue(i),e.close(),a.close(),[3,4];case 3:return r=o.sent(),e.close(),this.notifyError(r),[3,4];case 4:return[3,6];case 5:this.notifyError(Nt.TimestampIsNull),o.label=6;case 6:return[2]}})})}},Xt=function(){function e(e,t){if(this.headerBuffer=e,this.notifyError=t,this.ONE_TEXTURE_INPUT_ID=1869900081,this.INVALID_HEADER_ERROR="Invalid video frame header",this.UNSUPPORTED_LAYOUT_ERROR="Unsupported texture layout",this.headerDataView=new Uint32Array(e),this.headerDataView.length<8)throw this.notifyError(this.INVALID_HEADER_ERROR),new Error(this.INVALID_HEADER_ERROR);if(this.headerDataView[0]!==this.ONE_TEXTURE_INPUT_ID)throw this.notifyError(this.UNSUPPORTED_LAYOUT_ERROR),new Error(this.UNSUPPORTED_LAYOUT_ERROR)}return Object.defineProperty(e.prototype,"oneTextureLayoutId",{get:function(){return this.headerDataView[0]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"version",{get:function(){return this.headerDataView[1]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"frameRowOffset",{get:function(){return this.headerDataView[2]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"frameFormat",{get:function(){return this.headerDataView[3]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"frameWidth",{get:function(){return this.headerDataView[4]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"frameHeight",{get:function(){return this.headerDataView[5]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"multiStreamHeaderRowOffset",{get:function(){return this.headerDataView[6]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"multiStreamCount",{get:function(){return this.headerDataView[7]},enumerable:!1,configurable:!0}),e}(),Zt=function(){function e(e,t){this.metadataMap=new Map,this.AUDIO_INFERENCE_RESULT_STREAM_ID=828664161;for(var n=new Uint32Array(e),a=0,i=0;a<t;a++){var r=n[i++],o=n[i++],s=n[i++],c=new Uint8Array(e,o,s);this.metadataMap.set(r,c)}}return Object.defineProperty(e.prototype,"audioInferenceResult",{get:function(){return this.metadataMap.get(this.AUDIO_INFERENCE_RESULT_STREAM_ID)},enumerable:!1,configurable:!0}),e}(),$t=function(e,t){var n=this;this.notifyError=e,this.videoFrameHandler=t,this.shouldDiscardAudioInferenceResult=!1,this.transform=function(e,t){return zt(n,void 0,void 0,function(){var n,a,i,r,o,s,c,d;return Gt(this,function(l){switch(l.label){case 0:if(null===(n=e.timestamp))return[3,6];l.label=1;case 1:return l.trys.push([1,4,,5]),[4,this.extractVideoFrameAndMetadata(e)];case 2:return a=l.sent(),i=a.videoFrame,r=a.metadata,o=(void 0===r?{}:r).audioInferenceResult,[4,this.videoFrameHandler({videoFrame:i,audioInferenceResult:o})];case 3:return s=l.sent(),c=new VideoFrame(s,{timestamp:n}),t.enqueue(c),i.close(),e.close(),s.close(),[3,5];case 4:return d=l.sent(),e.close(),this.notifyError(d),[3,5];case 5:return[3,7];case 6:this.notifyError(Nt.TimestampIsNull),l.label=7;case 7:return[2]}})})},this.extractVideoFrameAndMetadata=function(e){return zt(n,void 0,void 0,function(){var t,n,a,i,r,o;return Gt(this,function(s){switch(s.label){case 0:if(Q())throw T;if("NV12"!==e.format)throw this.notifyError(Nt.UnsupportedVideoFramePixelFormat),new Error(Nt.UnsupportedVideoFramePixelFormat);return t={x:0,y:0,width:e.codedWidth,height:2},n=new ArrayBuffer(t.width*t.height*3/2),[4,e.copyTo(n,{rect:t})];case 1:return s.sent(),a=new Xt(n,this.notifyError),i={x:0,y:a.multiStreamHeaderRowOffset,width:e.codedWidth,height:e.codedHeight-a.multiStreamHeaderRowOffset},r=new ArrayBuffer(i.width*i.height*3/2),[4,e.copyTo(r,{rect:i})];case 2:return s.sent(),o=new Zt(r,a.multiStreamCount),[2,{videoFrame:new VideoFrame(e,{timestamp:e.timestamp,visibleRect:{x:0,y:a.frameRowOffset,width:a.frameWidth,height:a.frameHeight}}),metadata:{audioInferenceResult:this.shouldDiscardAudioInferenceResult?void 0:o.audioInferenceResult}}]}})})},we("video.mediaStream.audioInferenceDiscardStatusChange",function(e){var t=e.discardAudioInferenceResult;n.shouldDiscardAudioInferenceResult=t})};function en(e,t){return function(n,a){null==t||t.reportApplyingVideoEffect(n||"",a),e(n,a).then(function(){null==t||t.reportVideoEffectChanged(n||"",a),Ve("video.videoEffectReadiness",[!0,n,void 0,a])}).catch(function(e){var t=e in tn.EffectFailureReason?e:tn.EffectFailureReason.InitializationFailure;Ve("video.videoEffectReadiness",[!1,n,t,a])})}}var tn,nn,an,rn,on,sn,cn,dn,ln,un,fn=function(){return fn=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},fn.apply(this,arguments)},pn=function(e,t,n,a){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(n,r){function o(e){try{c(a.next(e))}catch(e){r(e)}}function s(e){try{c(a.throw(e))}catch(e){r(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((a=a.apply(e,t||[])).next())})},mn=function(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(e){return function(t){return c([e,t])}}function c(s){if(n)throw new TypeError("Generator is already executing.");for(;r&&(r=0,s[0]&&(o=0)),o;)try{if(n=1,a&&(i=2&s[0]?a.return:s[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,s[1])).done)return i;switch(a=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,a=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],a=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}};function _n(e,t){ue.initialize(t).then(function(){e&&e()})}function hn(){le.enablePrintCapability()}function bn(){le.print()}function gn(e){be(),Ve("getContext",function(t){t.frameContext||(t.frameContext=u.frameContext),e(t)})}function vn(e){ue.registerOnThemeChangeHandler(e)}function yn(e){Ae("fullScreenChange",e,[])}function Sn(e){Ae("appButtonClick",e,[E.content])}function Dn(e){Ae("appButtonHoverEnter",e,[E.content])}function In(e){Ae("appButtonHoverLeave",e,[E.content])}function xn(e){fe.backStack.registerBackButtonHandlerHelper(e)}function Cn(e){le.registerOnLoadHandlerHelper(e)}function On(e){le.registerBeforeUnloadHandlerHelper(e)}function wn(e){Ae("focusEnter",e,[])}function En(e){Ae("changeSettings",e,[E.content])}function An(e,t){ge($),fe.tabs.getTabInstances(t).then(function(t){e(t)})}function Ln(e,t){ge($),fe.tabs.getMruTabInstances(t).then(function(t){e(t)})}function kn(e){fe.shareDeepLink({subPageId:e.subEntityId,subPageLabel:e.subEntityLabel,subPageWebUrl:e.subEntityWebUrl})}function Mn(e,t){ge($,E.content,E.sidePanel,E.settings,E.task,E.stage,E.meetingStage),t=t||R(),ue.openLink(e).then(function(){t(!0)}).catch(function(e){t(!1,e.message)})}function Pn(e){fe.setCurrentFrame(e)}function Tn(e,t,n){fe.initializeWithFrameContext(e,t,n)}function Un(e){fe.returnFocus(e)}function Fn(e,t){ge($),t=t||R(),fe.tabs.navigateToTab(e).then(function(){t(!0)}).catch(function(e){t(!1,e.message)})}function Hn(e,t){ge($,E.content,E.sidePanel,E.settings,E.remove,E.task,E.stage,E.meetingStage),t=t||R(),fe.navigateCrossDomain(e).then(function(){t(!0)}).catch(function(e){t(!1,e.message)})}function Rn(e){ge($),e=e||R(),fe.backStack.navigateBack().then(function(){e(!0)}).catch(function(t){e(!1,t.message)})}!function(e){var t=Q()?void 0:new Vt(Ve);function n(e){Ve("video.notifyError",[e])}function a(){return ge($)&&!!$.supports.video&&(!!$.supports.video.mediaStream||!!$.supports.video.sharedFrame)}function i(){var e;return ge($,E.sidePanel)&&function(){var e,t,n,a;return!(!(null===(t=null===(e=q().chrome)||void 0===e?void 0:e.webview)||void 0===t?void 0:t.getTextureStream)||!(null===(a=null===(n=q().chrome)||void 0===n?void 0:n.webview)||void 0===a?void 0:a.registerTextureStream))}()&&!!(null===(e=$.supports.video)||void 0===e?void 0:e.mediaStream)}function r(){var e;return ge($,E.sidePanel)&&!!(null===(e=$.supports.video)||void 0===e?void 0:e.sharedFrame)}!function(e){e.NV12="NV12"}(e.VideoFrameFormat||(e.VideoFrameFormat={})),function(e){e.EffectChanged="EffectChanged",e.EffectDisabled="EffectDisabled"}(e.EffectChangeType||(e.EffectChangeType={})),function(e){e.InvalidEffectId="InvalidEffectId",e.InitializationFailure="InitializationFailure"}(e.EffectFailureReason||(e.EffectFailureReason={})),e.registerForVideoFrame=function(e){if(ge($,E.sidePanel),!a())throw T;if(!e.videoFrameHandler||!e.videoBufferHandler)throw new Error("Both videoFrameHandler and videoBufferHandler must be provided");if(we("video.setFrameProcessTimeLimit",function(e){return null==t?void 0:t.setFrameProcessTimeLimit(e.timeLimit)},!1),i())!function(e,r){var o=this;if(ge($,E.sidePanel),!a()||!i())throw T;we("video.startVideoExtensibilityVideoStream",function(a){return pn(o,void 0,void 0,function(){var i,r;return mn(this,function(o){switch(o.label){case 0:return i=a.streamId,r=function(e,t){var n=this;return function(a){return pn(n,void 0,void 0,function(){var n,i;return mn(this,function(r){switch(r.label){case 0:return n=a.videoFrame,null==t||t.reportStartFrameProcessing(n.codedWidth,n.codedHeight),[4,e(a)];case 1:return i=r.sent(),null==t||t.reportFrameProcessed(),[2,i]}})})}}(e,t),[4,Kt(i,r,n,t)];case 1:return o.sent(),[2]}})})},!1),Ve("video.mediaStream.registerForVideoFrame",[r])}(e.videoFrameHandler,e.config);else{if(!r())throw T;!function(e,i){if(ge($,E.sidePanel),!a()||!r())throw T;we("video.newVideoFrame",function(a){if(a){var i=a.timestamp;null==t||t.reportStartFrameProcessing(a.width,a.height),e(function(e){if("videoFrameBuffer"in e)return e;var t=e.data,n=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(a=Object.getOwnPropertySymbols(e);i<a.length;i++)t.indexOf(a[i])<0&&Object.prototype.propertyIsEnumerable.call(e,a[i])&&(n[a[i]]=e[a[i]])}return n}(e,["data"]);return fn(fn({},n),{videoFrameBuffer:t})}(a),function(){null==t||t.reportFrameProcessed(),function(e){Ve("video.videoFrameProcessed",[e])}(i)},n)}},!1),Ve("video.registerForVideoFrame",[i])}(e.videoBufferHandler,e.config)}null==t||t.startMonitorSlowFrameProcessing()},e.notifySelectedVideoEffectChanged=function(e,t){if(ge($,E.sidePanel),!a())throw T;Ve("video.videoEffectChanged",[e,t])},e.registerForVideoEffect=function(e){if(ge($,E.sidePanel),!a())throw T;we("video.effectParameterChange",en(e,t),!1),Ve("video.registerForVideoEffect")},e.isSupported=a}(tn||(tn={})),function(e){var t="search.queryChange",n="search.queryClose",a="search.queryExecute";function i(){return!(!ge($)||!$.supports.search)}e.registerHandlers=function(e,r,o){if(ge($,E.content),!i())throw T;we(n,e),we(a,r),o&&we(t,o)},e.unregisterHandlers=function(){if(ge($,E.content),!i())throw T;Ve("search.unregister"),Ee(t),Ee(n),Ee(a)},e.isSupported=i,e.closeSearch=function(){return new Promise(function(e){if(ge($,E.content),!i())throw new Error("Not supported");e(Re("search.closeSearch"))})}}(nn||(nn={})),function(e){function t(t){return new Promise(function(a){if(!n())throw T;a(Be(e.SharingAPIMessages.shareWebContent,t))})}function n(){return!(!ge($)||!$.supports.sharing)}e.SharingAPIMessages={shareWebContent:"sharing.shareWebContent"},e.shareWebContent=function(e,n){try{(function(e){if(!(e&&e.content&&e.content.length))throw{errorCode:I.INVALID_ARGUMENTS,message:"Shared content is missing"}})(e),function(e){if(e.content.some(function(e){return!e.type}))throw{errorCode:I.INVALID_ARGUMENTS,message:"Shared content type cannot be undefined"};if(e.content.some(function(t){return t.type!==e.content[0].type}))throw{errorCode:I.INVALID_ARGUMENTS,message:"Shared content must be of the same type"}}(e),function(e){if("URL"!==e.content[0].type)throw{errorCode:I.INVALID_ARGUMENTS,message:"Content type is unsupported"};if(e.content.some(function(e){return!e.url}))throw{errorCode:I.INVALID_ARGUMENTS,message:"URLs are required for URL content types"}}(e)}catch(e){return V(function(){return Promise.reject(e)},n)}return ge($,E.content,E.sidePanel,E.task,E.stage,E.meetingStage),V(t,n,e)},e.isSupported=n}(an||(an={})),function(e){function t(){return!(!ge($)||!$.supports.stageView)}e.open=function(e){return new Promise(function(n){if(ge($,E.content),!t())throw T;if(!e)throw new Error("[stageView.open] Stage view params cannot be null");n(Be("stageView.open",e))})},e.isSupported=t}(rn||(rn={})),function(e){function t(){return!(!ge($)||!$.supports.webStorage)}e.isWebStorageClearedOnUserLogOut=function(){return ge($),t()},e.isSupported=t}(on||(on={})),function(e){var t;function n(){return!(!ge($)||!$.supports.call)}!function(e){e.Unknown="unknown",e.Audio="audio",e.Video="video",e.VideoBasedScreenSharing="videoBasedScreenSharing",e.Data="data"}(t=e.CallModalities||(e.CallModalities={})),e.startCall=function(e){return new Promise(function(a){var i;if(ge($,E.content,E.task),!n())throw T;if(!$.isLegacyTeams)return Ve("call.startCall",[e],a);a(He("executeDeepLink",function(e,t,n){if(0===e.length)throw new Error("Must have at least one target when creating a call deep link");var a="".concat(mt,"=")+e.map(function(e){return encodeURIComponent(e)}).join(","),i=void 0===t?"":"&".concat("withVideo","=").concat(encodeURIComponent(t)),r=void 0===n?"":"&".concat("source","=").concat(encodeURIComponent(n));return"".concat(c,"://").concat(d).concat("/l/call/0/0","?").concat(a).concat(i).concat(r)}(e.targets,null===(i=e.requestedModalities)||void 0===i?void 0:i.includes(t.Video),e.source)).then(function(e){if(!e)throw new Error("The call was not properly started");return e}))})},e.isSupported=n}(sn||(sn={})),function(e){e.Messages=ue.Messages,e.FailedReason=ue.FailedReason,e.ExpectedFailureReason=ue.ExpectedFailureReason,e.notifyAppLoaded=function(){ue.notifyAppLoaded()},e.notifySuccess=function(){ue.notifySuccess()},e.notifyFailure=function(e){ue.notifyFailure(e)},e.notifyExpectedFailure=function(e){ue.notifyExpectedFailure(e)}}(cn||(cn={})),function(e){e.setValidityState=function(e){fe.config.setValidityState(e)},e.getSettings=function(e){ge($,E.content,E.settings,E.remove,E.sidePanel),fe.getConfig().then(function(t){e(t)})},e.setSettings=function(e,t){ge($,E.content,E.settings,E.sidePanel),t=t||R(),fe.config.setConfig(e).then(function(){t(!0)}).catch(function(e){t(!1,e.message)})},e.registerOnSaveHandler=function(e){fe.config.registerOnSaveHandlerHelper(e)},e.registerOnRemoveHandler=function(e){fe.config.registerOnRemoveHandlerHelper(e)}}(dn||(dn={})),function(e){function t(e){return e.height=e.height?e.height:P.Small,e.width=e.width?e.width:P.Small,e}e.startTask=function(e,t){var n=t?function(e){return t(e.err,e.result)}:void 0;return void 0===e.card&&void 0===e.url||e.card?(ge($,E.content,E.sidePanel,E.meetingStage),Ve("tasks.startTask",[e],t)):void 0!==e.completionBotId?ce.url.bot.open(function(e){return{url:e.url,size:{height:e.height?e.height:P.Small,width:e.width?e.width:P.Small},title:e.title,fallbackUrl:e.fallbackUrl,completionBotId:e.completionBotId}}(e),n):ce.url.open(function(e){return{url:e.url,size:{height:e.height?e.height:P.Small,width:e.width?e.width:P.Small},title:e.title,fallbackUrl:e.fallbackUrl}}(e),n),new Ht},e.updateTask=function(e){(e=t(e)).width,e.height;var n=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(a=Object.getOwnPropertySymbols(e);i<a.length;i++)t.indexOf(a[i])<0&&Object.prototype.propertyIsEnumerable.call(e,a[i])&&(n[a[i]]=e[a[i]])}return n}(e,["width","height"]);if(Object.keys(n).length)throw new Error("resize requires a TaskInfo argument containing only width and height");ce.update.resize(e)},e.submitTask=function(e,t){ce.url.submit(e,t)},e.getDefaultSizeIfNotProvided=t}(ln||(ln={})),function(e){!function(e){e.guest="Guest",e.attendee="Attendee",e.presenter="Presenter",e.organizer="Organizer"}(e.UserMeetingRole||(e.UserMeetingRole={})),function(e){e.added="Added",e.alreadyExists="AlreadyExists",e.conflict="Conflict",e.notFound="NotFound"}(e.ContainerState||(e.ContainerState={})),e.isSupported=function(){return!(!ge($,E.meetingStage,E.sidePanel)||!$.supports.interactive)}}(un||(un={}));var Nn=function(){function e(){}return e.prototype.getFluidTenantInfo=function(){return Bn(),new Promise(function(e){e(Be("interactive.getFluidTenantInfo"))})},e.prototype.getFluidToken=function(e){return Bn(),new Promise(function(t){t(Be("interactive.getFluidToken",e))})},e.prototype.getFluidContainerId=function(){return Bn(),new Promise(function(e){e(Be("interactive.getFluidContainerId"))})},e.prototype.setFluidContainerId=function(e){return Bn(),new Promise(function(t){t(Be("interactive.setFluidContainerId",e))})},e.prototype.getNtpTime=function(){return Bn(),new Promise(function(e){e(Be("interactive.getNtpTime"))})},e.prototype.registerClientId=function(e){return Bn(),new Promise(function(t){t(Be("interactive.registerClientId",e))})},e.prototype.getClientRoles=function(e){return Bn(),new Promise(function(t){t(Be("interactive.getClientRoles",e))})},e.prototype.getClientInfo=function(e){return Bn(),new Promise(function(t){t(Be("interactive.getClientInfo",e))})},e.create=function(){return Bn(),new e},e}();function Bn(){if(!un.isSupported())throw new Error("LiveShareHost Not supported")}const jn=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;var Vn=function(){return Vn=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Vn.apply(this,arguments)};function zn(e){try{return e.cartItems=Gn(e.cartItems),e}catch(e){throw new Error("Error deserializing cart")}}function Gn(e){return e.map(function(e){if(e.imageURL){var t=new URL(e.imageURL);e.imageURL=t}return e.accessories&&(e.accessories=Gn(e.accessories)),e})}var Kn=function(e){try{return e.map(function(e){var t=e.imageURL,n=e.accessories,a=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(a=Object.getOwnPropertySymbols(e);i<a.length;i++)t.indexOf(a[i])<0&&Object.prototype.propertyIsEnumerable.call(e,a[i])&&(n[a[i]]=e[a[i]])}return n}(e,["imageURL","accessories"]),i=Vn({},a);return t&&(i.imageURL=t.href),n&&(i.accessories=Kn(n)),i})}catch(e){throw new Error("Error serializing cart items")}};function Wn(e){if(null!=e){if(!Array.isArray(e)||0===e.length)throw new Error("CartItem.accessories must be a non-empty array");for(var t=0,n=e;t<n.length;t++){var a=n[t];if(a.accessories)throw new Error("Item in CartItem.accessories cannot have accessories");qn(a)}}}function qn(e){if(!e.id)throw new Error("cartItem.id must not be empty");if(!e.name)throw new Error("cartItem.name must not be empty");(function(e){if("number"!=typeof e||e<0)throw new Error("price ".concat(e," must be a number not less than 0"));if(parseFloat(e.toFixed(3))!==e)throw new Error("price ".concat(e," must have at most 3 decimal places"))})(e.price),function(e){if("number"!=typeof e||e<=0||parseInt(e.toString())!==e)throw new Error("quantity ".concat(e," must be an integer greater than 0"))}(e.quantity)}function Qn(e){if(null!=e){if(!e)throw new Error("id must not be empty");if(!1===function(e){return"string"==typeof e&&jn.test(e)}(e))throw new Error("id must be a valid UUID")}}var Yn,Jn,Xn,Zn,$n,ea,ta,na=function(){return na=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},na.apply(this,arguments)};!function(e){function t(){return!(!ge($)||!$.supports.marketplace)}e.cartVersion={majorVersion:1,minorVersion:1},function(e){e.TACAdminUser="TACAdminUser",e.TeamsAdminUser="TeamsAdminUser",e.TeamsEndUser="TeamsEndUser"}(e.Intent||(e.Intent={})),function(e){e.Open="Open",e.Processing="Processing",e.Processed="Processed",e.Closed="Closed",e.Error="Error"}(e.CartStatus||(e.CartStatus={})),e.getCart=function(){if(ge($,E.content,E.task),!t())throw T;return Be("marketplace.getCart",e.cartVersion).then(zn)},e.addOrUpdateCartItems=function(n){if(ge($,E.content,E.task),!t())throw T;if(!n)throw new Error("addOrUpdateCartItemsParams must be provided");return Qn(null==n?void 0:n.cartId),function(e){if(!Array.isArray(e)||0===e.length)throw new Error("cartItems must be a non-empty array");for(var t=0,n=e;t<n.length;t++){var a=n[t];qn(a),Wn(a.accessories)}}(null==n?void 0:n.cartItems),Be("marketplace.addOrUpdateCartItems",na(na({},n),{cartItems:Kn(n.cartItems),cartVersion:e.cartVersion})).then(zn)},e.removeCartItems=function(n){if(ge($,E.content,E.task),!t())throw T;if(!n)throw new Error("removeCartItemsParams must be provided");if(Qn(null==n?void 0:n.cartId),!Array.isArray(null==n?void 0:n.cartItemIds)||0===(null==n?void 0:n.cartItemIds.length))throw new Error("cartItemIds must be a non-empty array");return Be("marketplace.removeCartItems",na(na({},n),{cartVersion:e.cartVersion})).then(zn)},e.updateCartStatus=function(n){if(ge($,E.content,E.task),!t())throw T;if(!n)throw new Error("updateCartStatusParams must be provided");return Qn(null==n?void 0:n.cartId),function(e){if(!Object.values(Yn.CartStatus).includes(e))throw new Error("cartStatus ".concat(e," is not valid"))}(null==n?void 0:n.cartStatus),Be("marketplace.updateCartStatus",na(na({},n),{cartVersion:e.cartVersion})).then(zn)},e.isSupported=t}(Yn||(Yn={})),function(e){function t(e,t){return{errorCode:e,message:t}}!function(e){e.Dropbox="DROPBOX",e.Box="BOX",e.Sharefile="SHAREFILE",e.GoogleDrive="GOOGLEDRIVE",e.Egnyte="EGNYTE",e.SharePoint="SharePoint"}(e.CloudStorageProvider||(e.CloudStorageProvider={})),function(e){e[e.Sharepoint=0]="Sharepoint",e[e.WopiIntegration=1]="WopiIntegration",e[e.Google=2]="Google",e[e.OneDrive=3]="OneDrive",e[e.Recent=4]="Recent",e[e.Aggregate=5]="Aggregate",e[e.FileSystem=6]="FileSystem",e[e.Search=7]="Search",e[e.AllFiles=8]="AllFiles",e[e.SharedWithMe=9]="SharedWithMe"}(e.CloudStorageProviderType||(e.CloudStorageProviderType={})),function(e){e.ClassMaterials="classMaterials"}(e.SpecialDocumentLibraryType||(e.SpecialDocumentLibraryType={})),function(e){e.Readonly="readonly"}(e.DocumentLibraryAccessType||(e.DocumentLibraryAccessType={})),function(e){e.Downloaded="Downloaded",e.Downloading="Downloading",e.Failed="Failed"}(e.FileDownloadStatus||(e.FileDownloadStatus={})),function(e){e.Download="DOWNLOAD",e.Upload="UPLOAD",e.Delete="DELETE"}(e.CloudStorageProviderFileAction||(e.CloudStorageProviderFileAction={})),e.getCloudStorageFolders=function(e,t){if(ge($,E.content),!e||0===e.length)throw new Error("[files.getCloudStorageFolders] channelId name cannot be null or empty");if(!t)throw new Error("[files.getCloudStorageFolders] Callback cannot be null");Ve("files.getCloudStorageFolders",[e],t)},e.addCloudStorageFolder=function(e,t){if(ge($,E.content),!e||0===e.length)throw new Error("[files.addCloudStorageFolder] channelId name cannot be null or empty");if(!t)throw new Error("[files.addCloudStorageFolder] Callback cannot be null");Ve("files.addCloudStorageFolder",[e],t)},e.deleteCloudStorageFolder=function(e,t,n){if(ge($,E.content),!e)throw new Error("[files.deleteCloudStorageFolder] channelId name cannot be null or empty");if(!t)throw new Error("[files.deleteCloudStorageFolder] folderToDelete cannot be null or empty");if(!n)throw new Error("[files.deleteCloudStorageFolder] Callback cannot be null");Ve("files.deleteCloudStorageFolder",[e,t],n)},e.getCloudStorageFolderContents=function(e,t,n){if(ge($,E.content),!e||!t)throw new Error("[files.getCloudStorageFolderContents] folder/providerCode name cannot be null or empty");if(!n)throw new Error("[files.getCloudStorageFolderContents] Callback cannot be null");if("isSubdirectory"in e&&!e.isSubdirectory)throw new Error("[files.getCloudStorageFolderContents] provided folder is not a subDirectory");Ve("files.getCloudStorageFolderContents",[e,t],n)},e.openCloudStorageFile=function(e,t,n){if(ge($,E.content),!e||!t)throw new Error("[files.openCloudStorageFile] file/providerCode cannot be null or empty");if(e.isSubdirectory)throw new Error("[files.openCloudStorageFile] provided file is a subDirectory");Ve("files.openCloudStorageFile",[e,t,n])},e.getExternalProviders=function(e,t){if(void 0===e&&(e=!1),ge($,E.content),!t)throw new Error("[files.getExternalProviders] Callback cannot be null");Ve("files.getExternalProviders",[e],t)},e.copyMoveFiles=function(e,t,n,a,i,r){if(void 0===i&&(i=!1),ge($,E.content),!e||0===e.length)throw new Error("[files.copyMoveFiles] selectedFiles cannot be null or empty");if(!t)throw new Error("[files.copyMoveFiles] providerCode cannot be null or empty");if(!n)throw new Error("[files.copyMoveFiles] destinationFolder cannot be null or empty");if(!a)throw new Error("[files.copyMoveFiles] destinationProviderCode cannot be null or empty");if(!r)throw new Error("[files.copyMoveFiles] callback cannot be null");Ve("files.copyMoveFiles",[e,t,n,a,i],r)},e.getFileDownloads=function(e){if(ge($,E.content),!e)throw new Error("[files.getFileDownloads] Callback cannot be null");Ve("files.getFileDownloads",[],e)},e.openDownloadFolder=function(e,t){if(void 0===e&&(e=void 0),ge($,E.content),!t)throw new Error("[files.openDownloadFolder] Callback cannot be null");Ve("files.openDownloadFolder",[e],t)},e.addCloudStorageProvider=function(e){if(ge($,E.content),!e)throw t(I.INVALID_ARGUMENTS,"[files.addCloudStorageProvider] callback cannot be null");Ve("files.addCloudStorageProvider",[],e)},e.removeCloudStorageProvider=function(e,n){if(ge($,E.content),!n)throw t(I.INVALID_ARGUMENTS,"[files.removeCloudStorageProvider] callback cannot be null");if(!e||!e.content)throw t(I.INVALID_ARGUMENTS,"[files.removeCloudStorageProvider] 3P cloud storage provider request content is missing");Ve("files.removeCloudStorageProvider",[e],n)},e.addCloudStorageProviderFile=function(e,n){if(ge($,E.content),!n)throw t(I.INVALID_ARGUMENTS,"[files.addCloudStorageProviderFile] callback cannot be null");if(!e||!e.content)throw t(I.INVALID_ARGUMENTS,"[files.addCloudStorageProviderFile] 3P cloud storage provider request content is missing");Ve("files.addCloudStorageProviderFile",[e],n)},e.renameCloudStorageProviderFile=function(e,n){if(ge($,E.content),!n)throw t(I.INVALID_ARGUMENTS,"[files.renameCloudStorageProviderFile] callback cannot be null");if(!e||!e.content)throw t(I.INVALID_ARGUMENTS,"[files.renameCloudStorageProviderFile] 3P cloud storage provider request content is missing");Ve("files.renameCloudStorageProviderFile",[e],n)},e.deleteCloudStorageProviderFile=function(e,n){if(ge($,E.content),!n)throw t(I.INVALID_ARGUMENTS,"[files.deleteCloudStorageProviderFile] callback cannot be null");if(!(e&&e.content&&e.content.itemList&&e.content.itemList.length>0))throw t(I.INVALID_ARGUMENTS,"[files.deleteCloudStorageProviderFile] 3P cloud storage provider request content details are missing");Ve("files.deleteCloudStorageProviderFile",[e],n)},e.downloadCloudStorageProviderFile=function(e,n){if(ge($,E.content),!n)throw t(I.INVALID_ARGUMENTS,"[files.downloadCloudStorageProviderFile] callback cannot be null");if(!(e&&e.content&&e.content.itemList&&e.content.itemList.length>0))throw t(I.INVALID_ARGUMENTS,"[files.downloadCloudStorageProviderFile] 3P cloud storage provider request content details are missing");Ve("files.downloadCloudStorageProviderFile",[e],n)},e.uploadCloudStorageProviderFile=function(e,n){if(ge($,E.content),!n)throw t(I.INVALID_ARGUMENTS,"[files.uploadCloudStorageProviderFile] callback cannot be null");if(!(e&&e.content&&e.content.itemList&&e.content.itemList.length>0))throw t(I.INVALID_ARGUMENTS,"[files.uploadCloudStorageProviderFile] 3P cloud storage provider request content details are missing");if(!e.content.destinationFolder)throw t(I.INVALID_ARGUMENTS,"[files.uploadCloudStorageProviderFile] Invalid destination folder details");Ve("files.uploadCloudStorageProviderFile",[e],n)},e.registerCloudStorageProviderListChangeHandler=function(e){if(ge($),!e)throw new Error("[registerCloudStorageProviderListChangeHandler] Handler cannot be null");we("files.cloudStorageProviderListChange",e)},e.registerCloudStorageProviderContentChangeHandler=function(e){if(ge($),!e)throw new Error("[registerCloudStorageProviderContentChangeHandler] Handler cannot be null");we("files.cloudStorageProviderContentChange",e)}}(Jn||(Jn={})),function(e){function t(){return!(!ge($)||!$.supports.meetingRoom)}e.getPairedMeetingRoomInfo=function(){return new Promise(function(e){if(ge($),!t())throw T;e(Be("meetingRoom.getPairedMeetingRoomInfo"))})},e.sendCommandToPairedMeetingRoom=function(e){return new Promise(function(n){if(!e||0==e.length)throw new Error("[meetingRoom.sendCommandToPairedMeetingRoom] Command name cannot be null or empty");if(ge($),!t())throw T;n(Be("meetingRoom.sendCommandToPairedMeetingRoom",e))})},e.registerMeetingRoomCapabilitiesUpdateHandler=function(e){if(!e)throw new Error("[meetingRoom.registerMeetingRoomCapabilitiesUpdateHandler] Handler cannot be null");if(ge($),!t())throw T;we("meetingRoom.meetingRoomCapabilitiesUpdate",function(t){ge($),e(t)})},e.registerMeetingRoomStatesUpdateHandler=function(e){if(!e)throw new Error("[meetingRoom.registerMeetingRoomStatesUpdateHandler] Handler cannot be null");if(ge($),!t())throw T;we("meetingRoom.meetingRoomStatesUpdate",function(t){ge($),e(t)})},e.isSupported=t}(Xn||(Xn={})),function(e){function t(){return!(!ge($)||!$.supports.notifications)}e.showNotification=function(e){if(ge($,E.content),!t())throw T;Ve("notifications.showNotification",[e])},e.isSupported=t}(Zn||(Zn={})),function(e){function t(){return!(!ge($)||!$.supports.remoteCamera)}!function(e){e.Reset="Reset",e.ZoomIn="ZoomIn",e.ZoomOut="ZoomOut",e.PanLeft="PanLeft",e.PanRight="PanRight",e.TiltUp="TiltUp",e.TiltDown="TiltDown"}(e.ControlCommand||(e.ControlCommand={})),function(e){e[e.CommandResetError=0]="CommandResetError",e[e.CommandZoomInError=1]="CommandZoomInError",e[e.CommandZoomOutError=2]="CommandZoomOutError",e[e.CommandPanLeftError=3]="CommandPanLeftError",e[e.CommandPanRightError=4]="CommandPanRightError",e[e.CommandTiltUpError=5]="CommandTiltUpError",e[e.CommandTiltDownError=6]="CommandTiltDownError",e[e.SendDataError=7]="SendDataError"}(e.ErrorReason||(e.ErrorReason={})),function(e){e[e.None=0]="None",e[e.ControlDenied=1]="ControlDenied",e[e.ControlNoResponse=2]="ControlNoResponse",e[e.ControlBusy=3]="ControlBusy",e[e.AckTimeout=4]="AckTimeout",e[e.ControlTerminated=5]="ControlTerminated",e[e.ControllerTerminated=6]="ControllerTerminated",e[e.DataChannelError=7]="DataChannelError",e[e.ControllerCancelled=8]="ControllerCancelled",e[e.ControlDisabled=9]="ControlDisabled",e[e.ControlTerminatedToAllowOtherController=10]="ControlTerminatedToAllowOtherController"}(e.SessionTerminatedReason||(e.SessionTerminatedReason={})),e.getCapableParticipants=function(e){if(!e)throw new Error("[remoteCamera.getCapableParticipants] Callback cannot be null");if(ge($,E.sidePanel),!t())throw T;Ve("remoteCamera.getCapableParticipants",e)},e.requestControl=function(e,n){if(!e)throw new Error("[remoteCamera.requestControl] Participant cannot be null");if(!n)throw new Error("[remoteCamera.requestControl] Callback cannot be null");if(ge($,E.sidePanel),!t())throw T;Ve("remoteCamera.requestControl",[e],n)},e.sendControlCommand=function(e,n){if(!e)throw new Error("[remoteCamera.sendControlCommand] ControlCommand cannot be null");if(!n)throw new Error("[remoteCamera.sendControlCommand] Callback cannot be null");if(ge($,E.sidePanel),!t())throw T;Ve("remoteCamera.sendControlCommand",[e],n)},e.terminateSession=function(e){if(!e)throw new Error("[remoteCamera.terminateSession] Callback cannot be null");if(ge($,E.sidePanel),!t())throw T;Ve("remoteCamera.terminateSession",e)},e.registerOnCapableParticipantsChangeHandler=function(e){if(!e)throw new Error("[remoteCamera.registerOnCapableParticipantsChangeHandler] Handler cannot be null");if(ge($,E.sidePanel),!t())throw T;we("remoteCamera.capableParticipantsChange",e)},e.registerOnErrorHandler=function(e){if(!e)throw new Error("[remoteCamera.registerOnErrorHandler] Handler cannot be null");if(ge($,E.sidePanel),!t())throw T;we("remoteCamera.handlerError",e)},e.registerOnDeviceStateChangeHandler=function(e){if(!e)throw new Error("[remoteCamera.registerOnDeviceStateChangeHandler] Handler cannot be null");if(ge($,E.sidePanel),!t())throw T;we("remoteCamera.deviceStateChange",e)},e.registerOnSessionStatusChangeHandler=function(e){if(!e)throw new Error("[remoteCamera.registerOnSessionStatusChangeHandler] Handler cannot be null");if(ge($,E.sidePanel),!t())throw T;we("remoteCamera.sessionStatusChange",e)},e.isSupported=t}($n||($n={})),function(e){function t(){return!(!ge($)||!$.supports.appEntity)}e.selectAppEntity=function(e,n,a,i){if(ge($,E.content),!t())throw T;if(!e||0==e.length)throw new Error("[appEntity.selectAppEntity] threadId name cannot be null or empty");if(!i)throw new Error("[appEntity.selectAppEntity] Callback cannot be null");Ve("appEntity.selectAppEntity",[e,n,a],i)},e.isSupported=t}(ea||(ea={})),function(e){function t(){return!(!ge($)||!$.supports.teams)}!function(e){e[e.Regular=0]="Regular",e[e.Private=1]="Private",e[e.Shared=2]="Shared"}(e.ChannelType||(e.ChannelType={})),e.getTeamChannels=function(e,n){if(ge($,E.content),!t())throw T;if(!e)throw new Error("[teams.getTeamChannels] groupId cannot be null or empty");if(!n)throw new Error("[teams.getTeamChannels] Callback cannot be null");Ve("teams.getTeamChannels",[e],n)},e.refreshSiteUrl=function(e,n){if(ge($),!t())throw T;if(!e)throw new Error("[teams.refreshSiteUrl] threadId cannot be null or empty");if(!n)throw new Error("[teams.refreshSiteUrl] Callback cannot be null");Ve("teams.refreshSiteUrl",[e],n)},e.isSupported=t,function(e){function t(){return!(!ge($)||!$.supports.teams||!$.supports.teams.fullTrust)}!function(e){function t(){return!!(ge($)&&$.supports.teams&&$.supports.teams.fullTrust&&$.supports.teams.fullTrust.joinedTeams)}e.getUserJoinedTeams=function(e){return new Promise(function(n){if(ge($),!t())throw T;if((u.hostClientType===O.android||u.hostClientType===O.teamsRoomsAndroid||u.hostClientType===O.teamsPhones||u.hostClientType===O.teamsDisplays)&&!ve("2.0.1")){var a={errorCode:I.OLD_PLATFORM};throw new Error(JSON.stringify(a))}n(He("getUserJoinedTeams",e))})},e.isSupported=t}(e.joinedTeams||(e.joinedTeams={})),e.getConfigSetting=function(e){return new Promise(function(n){if(ge($),!t())throw T;n(He("getConfigSetting",e))})},e.isSupported=t}(e.fullTrust||(e.fullTrust={}))}(ta||(ta={}));var aa,ia=function(e,t,n,a){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(n,r){function o(e){try{c(a.next(e))}catch(e){r(e)}}function s(e){try{c(a.throw(e))}catch(e){r(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((a=a.apply(e,t||[])).next())})},ra=function(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(e){return function(t){return c([e,t])}}function c(s){if(n)throw new TypeError("Generator is already executing.");for(;r&&(r=0,s[0]&&(o=0)),o;)try{if(n=1,a&&(i=2&s[0]?a.return:s[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,s[1])).done)return i;switch(a=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,a=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],a=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}};!function(e){var t,n=Q()?void 0:new Vt(Ve);function a(){return ge($),tn.isSupported()}function i(e,n){void 0===n&&(n=t.Warn),Ve("video.notifyError",[e,n])}!function(e){e.Fatal="fatal",e.Warn="warn"}(t=e.ErrorLevel||(e.ErrorLevel={})),e.registerForVideoFrame=function(e){var t,r,o=this;if(!a())throw T;if(!e.videoFrameHandler||!e.videoBufferHandler)throw new Error("Both videoFrameHandler and videoBufferHandler must be provided");if(ge($,E.sidePanel)){if(we("video.setFrameProcessTimeLimit",function(e){return null==n?void 0:n.setFrameProcessTimeLimit(e)},!1),null===(t=$.supports.video)||void 0===t?void 0:t.mediaStream)we("video.startVideoExtensibilityVideoStream",function(t){return ia(o,void 0,void 0,function(){var a,r,o;return ra(this,function(s){switch(s.label){case 0:return a=t.streamId,r=t.metadataInTexture,o=n?function(e,t){var n=this;return function(a){return ia(n,void 0,void 0,function(){var n,i;return ra(this,function(r){switch(r.label){case 0:return n=a.videoFrame,t.reportStartFrameProcessing(n.codedWidth,n.codedHeight),[4,e(a)];case 1:return i=r.sent(),t.reportFrameProcessed(),[2,i]}})})}}(e.videoFrameHandler,n):e.videoFrameHandler,r?[4,Wt(a,o,i,n)]:[3,2];case 1:return s.sent(),[3,4];case 2:return[4,Kt(a,o,i,n)];case 3:s.sent(),s.label=4;case 4:return[2]}})})},!1),Ve("video.mediaStream.registerForVideoFrame",[e.config]);else{if(!(null===(r=$.supports.video)||void 0===r?void 0:r.sharedFrame))throw T;we("video.newVideoFrame",function(t){if(t){null==n||n.reportStartFrameProcessing(t.width,t.height);var a=t.timestamp;e.videoBufferHandler(function(e){return e.videoFrameBuffer=e.videoFrameBuffer||e.data,delete e.data,e}(t),function(){null==n||n.reportFrameProcessed(),function(e){Ve("video.videoFrameProcessed",[e])}(a)},i)}},!1),Ve("video.registerForVideoFrame",[e.config])}null==n||n.startMonitorSlowFrameProcessing()}},e.notifySelectedVideoEffectChanged=function(e,t,n){if(ge($,E.sidePanel),!a())throw T;Ve("video.videoEffectChanged",[e,t,n])},e.registerForVideoEffect=function(e){if(ge($,E.sidePanel),!a())throw T;we("video.effectParameterChange",en(e,n),!1),Ve("video.registerForVideoEffect")},e.updatePersonalizedEffects=function(e){if(ge($,E.sidePanel),!tn.isSupported())throw T;Ve("video.personalizedEffectsChanged",[e])},e.isSupported=a,e.notifyFatalError=function(e){if(ge($),!tn.isSupported())throw T;i(e,t.Fatal)}}(aa||(aa={}))})(),i})(),e.exports=n()}).call(this,n("8oxB"))},PwfB:function(e,t,n){var a=n("T/wG"),i=n("ruv1");"string"==typeof a&&(a=[[e.i,a]]);for(var r=0;r<a.length;r++)i.loadStyles(a[r][1],!0);a.locals&&(e.exports=a.locals)},"T/wG":function(e,t,n){(e.exports=n("JPst")(!1)).push([e.i,".chatDrawerOpen_b430718f{position:fixed;width:300px;height:600px;bottom:0;z-index:100;right:40px;background:#fff;border:1px solid #bebebe;border-top-left-radius:10px;border-top-right-radius:10px;box-shadow:0 0 0 1px rgba(0,0,0,.08),0 4px 4px 0 rgba(0,0,0,.3);transition:all .5s ease-in-out}.chatDrawerOpen_b430718f:hover{background-color:#f9fafb}.chatDrawerClose_b430718f{position:fixed;width:300px;height:45px;bottom:0;z-index:100;right:40px;background:#fff;border:1px solid #bebebe;border-top-left-radius:10px;border-top-right-radius:10px;box-shadow:0 0 0 1px rgba(0,0,0,.08),0 4px 4px 0 rgba(0,0,0,.3);transition:all .5s ease-in-out}.chatDrawerClose_b430718f:hover{background-color:#f9fafb}.chatSlideButton_b430718f{position:absolute;width:100%;cursor:pointer}.chatLabel_b430718f{height:40px;padding:7px 8px}.chatText_b430718f{color:#242424;font-size:14px;font-weight:600;position:absolute;left:50px;top:14px}.chatPicture_b430718f{width:32px;height:32px;border-radius:100%}.chatContent_b430718f{position:absolute;top:45px;width:100%}.chatFrame_b430718f{width:100%;height:560px;border:none}.openChatIcon_b430718f{position:absolute;right:8px;top:8px;height:30px;width:30px;border-radius:100%;cursor:pointer}.openChatIcon_b430718f:hover{background-color:#ebebeb}.openChatSVG_b430718f{fill:#646464;position:absolute;top:7px;left:7px}",""])},cDcd:function(e,t){e.exports=i},faye:function(e,t){e.exports=r},hLTl:function(e,t,n){"use strict";n.r(t);var a=n("wxtz"),i=n("GPet"),r=n("cDcd");n("PwfB");var o="openChatSVG_b430718f",s=function(e){var t=e.label,n=e.userPhoto,a=Object(r.useState)(),i=a[0],s=a[1];return Object(r.useEffect)(function(){void 0===i&&s(!1)}),r.createElement(r.Fragment,null,r.createElement("div",{className:"".concat(i?"chatDrawerOpen_b430718f":"chatDrawerClose_b430718f")},r.createElement("div",{className:"chatSlideButton_b430718f",onClick:function(){s(!1===i)}},r.createElement("div",{className:"chatLabel_b430718f"},r.createElement("img",{className:"chatPicture_b430718f",src:n}),r.createElement("span",{className:"chatText_b430718f"},t),r.createElement("span",{className:"openChatIcon_b430718f"},!1===i&&r.createElement("svg",{className:o,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16","data-supported-dps":"16x16",fill:"currentColor",width:"16",height:"16",focusable:"false"},r.createElement("path",{d:"M15 11L8 6.39 1 11V8.61L8 4l7 4.61z"})),!0===i&&r.createElement("svg",{className:o,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16","data-supported-dps":"16x16",fill:"currentColor",width:"16",height:"16",focusable:"false"},r.createElement("path",{d:"M1 5l7 4.61L15 5v2.39L8 12 1 7.39z"}))))),r.createElement("div",{className:"chatContent_b430718f"},r.createElement("iframe",{className:"chatFrame_b430718f",src:"https://teams.microsoft.com/embed-client/chats/list?layout=singlePane"}))))},c=n("faye");function d(...e){return e.filter(e=>!f(e)).map(e=>e.replace(/^[\\|/]/,"").replace(/[\\|/]$/,"")).join("/").replace(/\\/g,"/")}function l(e){return"function"==typeof e}function u(e){return Array.isArray(e)}function f(e){return null==e||e.length<1}function p(e){return null!=e}function m(e){return JSON.stringify(e)}function _(e,t){return Object.hasOwnProperty.call(e,t)}let h;function b(){return void 0===h&&(h=new v),h}class g{constructor(e){this.store=e,this.enabled=this.test()}get(e){if(!this.enabled)return null;const t=this.store.getItem(e);if(!p(t))return null;const n=JSON.parse(t);return new Date(n.expiration)<=new Date?(this.delete(e),null):n.value}put(e,t,n){this.enabled&&this.store.setItem(e,this.createPersistable(t,n))}delete(e){this.enabled&&this.store.removeItem(e)}async getOrPut(e,t,n){if(!this.enabled)return t();let a=this.get(e);return null===a&&(a=await t(),this.put(e,a,n)),a}async deleteExpired(){if(this.enabled)for(let e=0;e<this.store.length;e++){const t=this.store.key(e);null!==t&&/["|']?pnp["|']? ?: ?1/i.test(this.store.getItem(t))&&await this.get(t)}}test(){try{return this.store.setItem("t","t"),this.store.removeItem("t"),!0}catch(e){return!1}}createPersistable(e,t){return void 0===t&&(t=function(e,t,n){let a=new Date(e.toString());switch("minute".toLowerCase()){case"year":a.setFullYear(a.getFullYear()+5);break;case"quarter":a.setMonth(a.getMonth()+15);break;case"month":a.setMonth(a.getMonth()+5);break;case"week":a.setDate(a.getDate()+35);break;case"day":a.setDate(a.getDate()+5);break;case"hour":a.setTime(a.getTime()+18e6);break;case"minute":a.setTime(a.getTime()+3e5);break;case"second":a.setTime(a.getTime()+5e3);break;default:a=void 0}return a}(new Date)),m({pnp:1,expiration:t,value:e})}}class v{constructor(e=new Map){this._store=e}get length(){return this._store.size}clear(){this._store.clear()}getItem(e){return this._store.get(e)}key(e){return Array.from(this._store)[e][0]}removeItem(e){this._store.delete(e)}setItem(e,t){this._store.set(e,t)}}function y(){return function(e,...t){const n=[...e];for(let e=0;e<n.length;e++)Reflect.apply(n[e],this,t)}}function S(){return async function(e,...t){return[...e].reduce((e,t)=>e.then(e=>Reflect.apply(t,this,e)),Promise.resolve(t))}}function D(){return function(e,...t){const n=[...e];for(let e=0;e<n.length;e++)Reflect.apply(n[e],this,t);return this}}const I=Symbol.for("ObserverLifecycleFlags");var x;!function(e){e[e.noInherit=1]="noInherit",e[e.once=2]="once"}(x||(x={}));const C=e=>t=>!((t[I]||0)&e),O=e=>t=>(t[I]=(t[I]||0)|e,t);function w(e,t,n,a){if(!l(n))throw Error("Observers must be functions.");if(Reflect.has(e,t))switch(a){case"add":e[t].push(n);break;case"prepend":e[t].unshift(n);break;case"replace":e[t].length=0,e[t].push(n)}else e[t]=[n];return e[t]}O(1),O(2);let E=!1;const A=Symbol.for("PnPExt"),L=new Map;function k(e,t,n,...a){if(E&&Reflect.has(n,A)){const t=[...Reflect.get(n,A)];let i;for(let r=0;r<t.length;r++){const o=t[r];if(l(o)?i=o(e,n,...a):"get"===e&&Reflect.has(o,a[0])?i=Reflect.get(o,a[0],n):Reflect.has(o,e)&&(i=Reflect.get(o,e)(n,...a)),void 0!==i)return i}}return t(n,...a)}function M(e,t,n,a){Reflect.defineProperty(e.prototype,t,{configurable:!0,enumerable:!0,get:function(){return n(this,a||t)}})}function P(e,t={headers:{}}){return{method:e,...t,headers:{...t.headers}}}function T(e){return this.start(P("GET",e))}function U(e){return this.start(P("POST",e))}function F(e){return this.start(P("PATCH",e))}function H(e){return this.start(P("DELETE",e))}function R(e,t,n){return Reflect.apply(t,e,[n])}Object.create,Object.create;const N={construct:D(),pre:S(),auth:S(),send:async function(e,...t){if(!u(e)||e.length<1)return;const n=e[0];return Reflect.apply(n,this,t)},parse:S(),post:S(),data:y()};let B=class extends class{constructor(e,t={}){this.moments=e,this.observers=t,this._onProxy=null,this._emitProxy=null,this._inheritingObservers=!0}using(...e){for(let t=0;t<e.length;t++)e[t](this);return this}get on(){return null===this._onProxy&&(this._onProxy=new Proxy(this,{get:(e,t)=>Object.assign(n=>(e.cloneObserversOnChange(),w(e.observers,t,n,"add"),e),{toArray:()=>Reflect.has(e.observers,t)?[...Reflect.get(e.observers,t)]:[],replace:n=>(e.cloneObserversOnChange(),w(e.observers,t,n,"replace"),e),prepend:n=>(e.cloneObserversOnChange(),w(e.observers,t,n,"prepend"),e),clear:()=>!!Reflect.has(e.observers,t)&&(e.cloneObserversOnChange(),e.observers[t].length=0,!0)})})),this._onProxy}log(e,t=0){this.emit.log(e,t)}error(e){p(e)&&this.emit.error(e)}get emit(){return null===this._emitProxy&&(this._emitProxy=new Proxy(this,{get:(e,t)=>(...n)=>{const a=Reflect.has(e.observers,t)?Reflect.get(e.observers,t):[];if((!u(a)||a.length<1)&&"error"===t)throw Error(`Unhandled Exception: ${n[0]}`);try{const i=Reflect.has(e.moments,t)?Reflect.get(e.moments,t):"init"===t||"dispose"===t?D():y();return Reflect.apply(i,e,[a,...n])}catch(e){if("error"===t)throw e;this.error(e)}finally{a&&a.length>0&&Reflect.set(e.observers,t,a.filter(C(2)))}}})),this._emitProxy}start(e){this.emit.init();const t=this.execute(e);return t.finally(()=>{try{this.emit.dispose()}catch(e){const t=Object.assign(Error("Error in dispose."),{innerException:e});this.error(t)}}).catch(()=>{}),t}cloneObserversOnChange(){var e;this._inheritingObservers&&(this._inheritingObservers=!1,this.observers=(e=this.observers,Reflect.ownKeys(e).reduce((t,n)=>(t[n]=[...e[n].filter(C(1))],t),{})))}}{constructor(e,t){let n;if(super(N),this.InternalResolve=Symbol.for("Queryable_Resolve"),this.InternalReject=Symbol.for("Queryable_Reject"),this.InternalPromise=Symbol.for("Queryable_Promise"),this._query=new URLSearchParams,this.moments[this.InternalPromise]=function(e,...t){return[...e].reduce((e,t)=>Reflect.apply(t,this,e),t)},"string"==typeof e)this._url=d(e,t);else if(u(e)){if(2!==e.length)throw Error("When using the tuple param exactly two arguments are expected.");if("string"!=typeof e[1])throw Error("Expected second tuple param to be a string.");n=e[0],this._url=d(e[1],t)}else n=e,this._url=d(n._url,t);void 0!==n&&(this.observers=n.observers,this._inheritingObservers=!0)}concat(e){return this._url+=e,this}toRequestUrl(){let e=this.toUrl();const t=this.query.toString();return f(t)||(e+=`${e.indexOf("?")>-1?"&":"?"}${t}`),e}get query(){return this._query}toUrl(){return this._url}execute(e){if(Reflect.ownKeys(this.observers).length<1)throw Error("No observers registered for this request. (https://pnp.github.io/pnpjs/queryable/queryable#no-observers-registered-for-this-request)");setTimeout(async()=>{const t=function(){let e=Date.now();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?n:3&n|8).toString(16)})}();let n;const a=(e,n)=>{this.log(`[${t}] ${e}`,n)};try{a("Beginning request",0);const i={...e,headers:{...e.headers,"X-PnPjs-RequestId":t}};let[r,o,s]=await this.emit.pre(this.toRequestUrl(),i,void 0);if(a(`Url: ${r}`,1),void 0!==s)return a("Result returned from pre, Emitting data"),this.emit.data(s),void a("Emitted data");a("Emitting auth"),[n,o]=await this.emit.auth(new URL(r),o),a("Emitted auth"),o={...o,...e,headers:{...o.headers,...e.headers}},a("Emitting send");let c=await this.emit.send(n,o);a("Emitted send"),a("Emitting parse"),[n,c,s]=await this.emit.parse(n,c,s),a("Emitted parse"),a("Emitting post"),[n,s]=await this.emit.post(n,s),a("Emitted post"),a("Emitting data"),this.emit.data(s),a("Emitted data")}catch(e){a(`Emitting error: "${e.message||e}"`,3),this.error(e),a("Emitted error",3)}finally{a("Finished request",0)}},0);let t=new Promise((e,t)=>{this.on[this.InternalResolve].replace(e),this.on[this.InternalReject].replace(t)});return[t]=this.emit[this.InternalPromise](t),t}};var j;function V(e,t){return Object.assign({body:m(e)},t)}async function z(e,t,n){if(!t.ok)throw await W.init(t);return[e,t,n]}function G(e){let t=e;return _(e,"d")?t=_(e.d,"results")?e.d.results:e.d:_(e,"value")&&(t=e.value),t}function K(e){return t=>(t.on.parse.replace(z),t.on.parse(async(t,n,a)=>(n.ok&&void 0===a&&(a=await e(n)),[t,n,a])),t)}B=function(e,t,n,a){var i,r=arguments.length,o=r<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(r<3?i(o):r>3?i(t,n,o):i(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o}([e=>new Proxy(e,{construct(t,n,a){let i=Reflect.construct(t,n,a);const r=Reflect.getPrototypeOf(e);if(Reflect.has(r,A)){const e=L.get(Reflect.get(r,A));e&&(i=function(e,t){return E=!0,Reflect.has(e,A)||Reflect.defineProperty(e,A,{writable:!0,value:[]}),n=Reflect.get(e,A),u(a=t)?n.push(...a):n.push(a),e;var n,a}(i,e))}const o=new Proxy(i,{apply:(e,t,n)=>k("apply",(...e)=>Reflect.apply(...e),e,o,n),get:(e,t,n)=>k("get",(...e)=>Reflect.get(...e),e,t,n),has:(e,t)=>k("has",(...e)=>Reflect.has(...e),e,t),set:(e,t,n,a)=>k("set",(...e)=>Reflect.set(...e),e,t,n,a)});return o}}),(l(j)||(j=function(e){return R(this,T,e)}),e=>new Proxy(e,{construct(e,t,n){const a=Object.assign(function(e){const t=void 0===this?a:this;return Reflect.apply(j,t,[e])},Reflect.construct(e,t,n));return Reflect.setPrototypeOf(a,n.prototype),a}}))],B);class W extends Error{constructor(e,t,n=t.status,a=t.statusText){super(e),this.response=t,this.status=n,this.statusText=a,this.isHttpRequestError=!0}static async init(e){const t=await e.clone().text();return new W(`Error making HttpClient request in queryable [${e.status}] ${e.statusText} ::> ${t}`,e)}}function q(e="eventual"){return t=>(t.on.pre(async function(t,n,a){return n.headers={...n.headers,ConsistencyLevel:e},[t,n,a]}),t)}function Q(e,t=!1){const n=$(e).using(function(e=!1){return t=>(t.on.parse.replace(z),t.on.parse(async(n,a,i)=>{const r=await a.text(),o=r.replace(/\s/gi,"").length>0?JSON.parse(r):{},s=o["@odata.nextLink"],c=e&&_(o,"@odata.count")?parseInt(o["@odata.count"],10):0,d=!f(s);return[n,a,{count:c,hasNext:d,next:()=>d?Q($([t,s]),e)():null,value:G(o)}]}),t)}(t),q()),a=["$search","$top","$select","$expand","$filter","$orderby"];t&&(n.query.has("$count")||/\$count=true/i.test(n.toUrl())||n.query.set("$count","true"),a.push("$count"));for(let t=0;t<a.length;t++){const i=e.query.get(a[t]);p(i)&&n.query.set(a[t],i)}return n}new class{constructor(e=null,t=null){this._local=e,this._session=t}get local(){return null===this._local&&(this._local=new g("undefined"==typeof localStorage?b():localStorage)),this._local}get session(){return null===this._session&&(this._session=new g("undefined"==typeof sessionStorage?b():sessionStorage)),this._session}},Symbol.for("CancelScopeId"),new Map;const Y=e=>{return t=e,(e,n)=>{const a=new t(e,n);return a.emit.construct(e,n),a};var t};class J extends B{constructor(e,t){super(e,t),"string"==typeof e?this.parentUrl=e:u(e)?this.parentUrl=e[0].toUrl():this.parentUrl=e.toUrl()}select(...e){return e.length>0&&this.query.set("$select",e.join(",")),this}expand(...e){return e.length>0&&this.query.set("$expand",e.join(",")),this}getParent(e,t=this.parentUrl,n){return"string"==typeof t&&(t=[this,t]),new e(t,n)}}const X=Y(J);class Z extends J{filter(e){return this.query.set("$filter",e),this}orderBy(e,t=!0){var n;const a="$orderby",i=(null===(n=this.query.get(a))||void 0===n?void 0:n.split(","))||[];return i.push(`${e} ${t?"asc":"desc"}`),this.query.set(a,i.join(",")),this}top(e){return this.query.set("$top",e.toString()),this}skip(e){return this.query.set("$skip",e.toString()),this}search(e){return this.using(q()),this.query.set("$search",e),this}skipToken(e){return this.query.set("$skiptoken",e),this}async count(){const e=Q(this);return(await e.top(1)()).count}paged(){return Q(this)()}}const $=Y(Z);class ee extends J{}Y(ee);class te{constructor(e=""){this._root=X(e)}using(...e){return this._root.using(...e),this}create(e,t){return e(this._root,t)}}const ne=(e,t)=>R(e,U,t),ae=(e,t)=>R(e,F,t);function ie(e,t,n,a){var i,r=arguments.length,o=r<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(r<3?i(o):r>3?i(t,n,o):i(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o}function re(e){return function(t){return class extends t{constructor(...t){super(t[0],t.length>1&&void 0!==t[1]?t[1]:e)}}}}function oe(){return function(e){return class extends e{delete(){return R(this,H,undefined)}}}}function se(){return function(e){return class extends e{update(e){return ae(this,V(e))}}}}function ce(e){return function(t){return class extends t{getById(t){return e(this,t)}}}}Object.create,Object.create;let de=class extends ee{getMemberObjects(e=!1){return ne(le(this,"getMemberObjects"),V({securityEnabledOnly:e}))}getMemberGroups(e=!1){return ne(le(this,"getMemberGroups"),V({securityEnabledOnly:e}))}checkMemberGroups(e){return ne(le(this,"checkMemberGroups"),V({groupIds:e}))}};de=ie([oe()],de);const le=Y(de);let ue=class extends Z{getByIds(e,t=pe.directoryObject){return ne(fe(this,"getByIds"),V({ids:e,type:t}))}async count(){const e=Q(this,!0);return(await e.top(1)()).count}paged(){return Q(this,!0)()}};ue=ie([re("directoryObjects"),ce(le)],ue);const fe=Y(ue);var pe;!function(e){e[e.directoryObject=0]="directoryObject",e[e.user=1]="user",e[e.group=2]="group",e[e.device=3]="device"}(pe||(pe={}));let me=class extends de{get memberOf(){return fe(this,"memberOf")}get transitiveMemberOf(){return fe(this,"transitiveMemberOf")}get people(){return ve(this)}get directReports(){return ve(this,"directReports")}get manager(){return _e(this,"manager")}};me=ie([se(),oe()],me);const _e=Y(me);let he=class extends ue{};he=ie([re("users"),ce(_e)],he);const be=Y(he);let ge=class extends ue{};ge=ie([re("people")],ge);const ve=Y(ge);var ye;Reflect.defineProperty(te.prototype,"me",{configurable:!0,enumerable:!0,get:function(){return this.create(_e,"me")}}),Reflect.defineProperty(te.prototype,"users",{configurable:!0,enumerable:!0,get:function(){return this.create(be)}}),function(e){e[e.Office365=0]="Office365",e[e.Dynamic=1]="Dynamic",e[e.Security=2]="Security"}(ye||(ye={}));let Se=class extends de{addFavorite(){return ne(De(this,"addFavorite"))}removeFavorite(){return ne(De(this,"removeFavorite"))}resetUnseenCount(){return ne(De(this,"resetUnseenCount"))}subscribeByMail(){return ne(De(this,"subscribeByMail"))}unsubscribeByMail(){return ne(De(this,"unsubscribeByMail"))}getCalendarView(e,t){const n=De(this,"calendarView");return n.query.set("startDateTime",e.toISOString()),n.query.set("endDateTime",t.toISOString()),n()}};Se=ie([oe(),se()],Se);const De=Y(Se);let Ie=class extends ue{async add(e,t,n,a={}){let i={displayName:e,mailEnabled:n===ye.Office365,mailNickname:t,securityEnabled:n!==ye.Office365,...a};n!==ye.Security&&(i={...i,groupTypes:n===ye.Office365?["Unified"]:["DynamicMembership"]});const r=await ne(this,V(i));return{data:r,group:this.getById(r.id)}}};Ie=ie([re("groups"),ce(De)],Ie),Y(Ie);let xe=class extends ee{getBlob(){return Ce(this,"$value").using(K(e=>e.blob()))()}getBuffer(){return Ce(this,"$value").using(K(e=>l(e.arrayBuffer)?e.arrayBuffer():e.buffer()))()}setContent(e){return ae(Ce(this,"$value"),{body:e})}};xe=ie([re("photo")],xe);const Ce=Y(xe);M(Se,"photo",Ce),M(me,"photo",Ce);var Oe,we=n("91a9"),Ee=n("O7od"),Ae=(Oe=function(e,t){return Oe=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},Oe(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}Oe(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),Le=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Ae(t,e),t.prototype.onInit=function(){return e=this,void 0,n=function(){var e,t,n,a,o;return function(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(i=2&r[0]?a.return:r[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,r[1])).done)return i;switch(a=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,a=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){o.label=r[1];break}if(6===r[0]&&o.label<i[1]){o.label=i[1],i=r;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(r);break}i[2]&&o.ops.pop(),o.trys.pop();continue}r=t.call(e,o)}catch(e){r=[6,e],a=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}}(this,function(l){switch(l.label){case 0:return l.trys.push([0,3,,5]),[4,Ee.app.initialize()];case 1:return l.sent(),[4,Ee.app.getContext()];case 2:return l.sent()?[2]:[3,5];case 3:return l.sent(),this._bottomPlaceholder=this.context.placeholderProvider.tryCreateContent(i.PlaceholderName.Bottom),e=function(e=""){return"object"!=typeof e||Reflect.has(e,"length")||(e=e._root),new te(e)}().using((u=this.context,e=>(e.using(e=>(e.using(function(e,t=!1){return n=>{const a=async function(t,n,a){return n.headers={...n.headers,...e},[t,n,a]};return t?n.on.pre.prepend(a):n.on.pre(a),n}}({"Content-Type":"application/json"})),e),function(e="https://graph.microsoft.com/v1.0"){return t=>(t.using(e=>(e.on.pre(async function(e,t,n){return t.headers={...t.headers,SdkVersion:"PnPCoreJS/3.16.0"},this.log(`Request Tag: ${t.headers.SdkVersion}`,0),[e,t,n]}),e),e=>(e.on.error(function(e){this.emit[this.InternalReject](e)}),e),e=>(e.on.data(function(e){this.emit[this.InternalResolve](e)}),e)),t.on.pre(async(t,n,a)=>(n.cache="default",n.credentials="same-origin",function(e){return/^https?:\/\/|^\/\//i.test(e)}(t)||(t=d(e,t)),[t,n,a])),t)}(),function(e){const{interval:t,replace:n,retries:a}={replace:!0,interval:200,retries:3};return e=>(n&&e.on.send.clear(),e.on.send(function(e,n){let i,r,o=t,s=0;const c=async()=>{if(s>=a)throw r||new W(`Retry count exceeded (${a}) for this request. ${i.status}: ${i.statusText};`,i);if(s++,void 0!==i&&429!==(null==i?void 0:i.status)&&503!==(null==i?void 0:i.status)&&504!==(null==i?void 0:i.status))return i;void 0!==i&&(i.headers.has("Retry-After")?o=1e3*parseInt(i.headers.get("Retry-After"),10):o*=2,this.log(`Attempt #${s} to retry request which failed with ${i.status}: ${i.statusText}`,0),await(t=o,new Promise(e=>{setTimeout(e,t)})));try{const t=e.toString();return this.log(`Fetch: ${n.method} ${t}`,0),i=await fetch(t,n),i.ok?i:c()}catch(e){if(/AbortError/.test(e.name))throw e;return r=e,c()}var t};return c()}),e)}(),K(async e=>{if(e.headers.has("Content-Length")&&0===parseFloat(e.headers.get("Content-Length"))||204===e.status)return{};const t=await e.text();return G(t.replace(/\s/gi,"").length>0?JSON.parse(t):{})}),function(e){return t=>(t.on.auth.replace(async function(t,n){const a=await e.aadTokenProviderFactory.getTokenProvider(),i=await a.getToken(`${t.protocol}//${t.hostname}`);return n.headers.Authorization=`Bearer ${i}`,[t,n]}),t)}(u)),e))),[4,e.me.photo.getBlob()];case 4:return t=l.sent(),n=window.URL||window.webkitURL,a=n.createObjectURL(t),o=r.createElement(s,{label:we.Label,userPhoto:a}),c.render(o,this._bottomPlaceholder.domElement),[3,5];case 5:return[2,Promise.resolve()]}var u})},new((t=void 0)||(t=Promise))(function(a,i){function r(e){try{s(n.next(e))}catch(e){i(e)}}function o(e){try{s(n.throw(e))}catch(e){i(e)}}function s(e){var n;e.done?a(e.value):(n=e.value,n instanceof t?n:new t(function(e){e(n)})).then(r,o)}s((n=n.apply(e,[])).next())});var e,t,n},function(e,t,n,a){var i,r=arguments.length,o=r<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(r<3?i(o):r>3?i(t,n,o):i(t,n))||o);r>3&&o&&Object.defineProperty(t,n,o)}([a.override],t.prototype,"onInit",null),t}(i.BaseApplicationCustomizer);t.default=Le},ruv1:function(e,t,n){"use strict";(function(e){var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},n.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.splitStyles=t.detokenize=t.clearStyles=t.loadTheme=t.flush=t.configureRunMode=t.configureLoadStyles=t.loadStyles=void 0;var a,i="undefined"==typeof window?e:window,r=i&&i.CSPSettings&&i.CSPSettings.nonce,o=((a=i.__themeState__||{theme:void 0,lastStyleElement:void 0,registeredStyles:[]}).runState||(a=n(n({},a),{perf:{count:0,duration:0},runState:{flushTimer:0,mode:0,buffer:[]}})),a.registeredThemableStyles||(a=n(n({},a),{registeredThemableStyles:[]})),i.__themeState__=a,a),s=/[\'\"]\[theme:\s*(\w+)\s*(?:\,\s*default:\s*([\\"\']?[\.\,\(\)\#\-\s\w]*[\.\,\(\)\#\-\w][\"\']?))?\s*\][\'\"]/g,c=function(){return"undefined"!=typeof performance&&performance.now?performance.now():Date.now()};function d(e){var t=c();e();var n=c();o.perf.duration+=n-t}function l(){d(function(){var e=o.runState.buffer.slice();o.runState.buffer=[];var t=[].concat.apply([],e);t.length>0&&u(t)})}function u(e,t){o.loadStyles?o.loadStyles(m(e).styleString,e):function(e){if("undefined"!=typeof document){var t=document.getElementsByTagName("head")[0],n=document.createElement("style"),a=m(e),i=a.styleString,s=a.themable;n.setAttribute("data-load-themed-styles","true"),r&&n.setAttribute("nonce",r),n.appendChild(document.createTextNode(i)),o.perf.count++,t.appendChild(n);var c=document.createEvent("HTMLEvents");c.initEvent("styleinsert",!0,!1),c.args={newStyle:n},document.dispatchEvent(c);var d={styleElement:n,themableStyle:e};s?o.registeredThemableStyles.push(d):o.registeredStyles.push(d)}}(e)}function f(e){void 0===e&&(e=3),3!==e&&2!==e||(p(o.registeredStyles),o.registeredStyles=[]),3!==e&&1!==e||(p(o.registeredThemableStyles),o.registeredThemableStyles=[])}function p(e){e.forEach(function(e){var t=e&&e.styleElement;t&&t.parentElement&&t.parentElement.removeChild(t)})}function m(e){var t=o.theme,n=!1;return{styleString:(e||[]).map(function(e){var a=e.theme;if(a){n=!0;var i=t?t[a]:void 0,r=e.defaultValue||"inherit";return t&&!i&&console,i||r}return e.rawString}).join(""),themable:n}}function _(e){var t=[];if(e){for(var n=0,a=void 0;a=s.exec(e);){var i=a.index;i>n&&t.push({rawString:e.substring(n,i)}),t.push({theme:a[1],defaultValue:a[2]}),n=s.lastIndex}t.push({rawString:e.substring(n)})}return t}t.loadStyles=function(e,t){void 0===t&&(t=!1),d(function(){var n=Array.isArray(e)?e:_(e),a=o.runState,i=a.mode,r=a.buffer,s=a.flushTimer;t||1===i?(r.push(n),s||(o.runState.flushTimer=setTimeout(function(){o.runState.flushTimer=0,l()},0))):u(n)})},t.configureLoadStyles=function(e){o.loadStyles=e},t.configureRunMode=function(e){o.runState.mode=e},t.flush=l,t.loadTheme=function(e){o.theme=e,function(){if(o.theme){for(var e=[],t=0,n=o.registeredThemableStyles;t<n.length;t++){var a=n[t];e.push(a.themableStyle)}e.length>0&&(f(1),u([].concat.apply([],e)))}}()},t.clearStyles=f,t.detokenize=function(e){return e&&(e=m(_(e)).styleString),e},t.splitStyles=_}).call(this,n("yLpj"))},wxtz:function(e,t){e.exports=o},yLpj:function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n}})});